
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Headspring Labs</title>
	<meta name="author" content="Headspring Labs">

	
	<meta name="description" content="Software management company provides additional options for customers.
&nbsp;
AUSTIN, TX – (January 24, 2013) – Headspring, a leading custom &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Headspring Labs" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><a href="/"><h1>Headspring Labs</h1></a>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/team">The Team</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/open-source">Open Source</a></li>
	<li><a href="/about-us">About Us</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:headspringlabs.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/HeadspringLabs" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/HeadspringLabs" title="GitHub">GitHub</a>
		
	    
		
		<a class="coderwall" href="https://coderwall.com/team/headspring" title="Coderwall">Coderwall</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:headspringlabs.com">
	</form>
</nav>
<nav id="main-nav"><ul class="main">
	<li><a href="/team">The Team</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/open-source">Open Source</a></li>
	<li><a href="/about-us">About Us</a></li>
</ul>
</nav>

</header>
	
		
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/HeadspringLabs">HeadspringLabs</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('HeadspringLabs', 5, );
	})(jQuery);
</script>

	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/headspring-forms-strategic-alliance-with-clear-measure-in-support-of-new-business-enterprise/">
		
			Headspring Forms Strategic Alliance With Clear Measure in Support of New Business Enterprise</a>
	</h2>
	<div class="entry-content">
		<h3><em style="font-size: 1.17em;">Software management company provides additional options for customers.</em></h3>
<p>&nbsp;</p>
<p><b>AUSTIN, TX – (January 24, 2013) – </b>Headspring, a leading custom software development company, today announced a strategic alliance with Clear Measure, a software management solutions company recently founded by Headspring’s former president and COO, Jeffrey Palermo. Clear Measure complements Headspring’s existing services by providing software management consulting and professional services. The alliance allows Headspring to add another option to its robust package of services for its customers.</p>
<p>Headspring has experienced rapid growth increasing revenues by more than 50 percent year over year, and in 2011 Headspring experienced a 162 percent increase in the number of clients the company served through the software development and software consulting projects. In 2012, the company added 12 new employees and plans to continue expanding opening an office in Houston, Texas in January 2013.</p>
<p>“We are committed to the continual growth and improvement of our business and our team,” said Dustin Wells, CEO of Headspring.  “This alliance exemplifies our belief that supporting our team’s growth and entrepreneurial instincts turns into exciting new opportunities. We are thrilled to support Jeffrey in this new venture.”</p>
<p>Headspring will provide Clear Measure access to expert software engineering services by developers who are recognized leaders in the industry and Clear Measure will provide management consulting and project management services such as systems assessments, data monitoring, and continual auditing.</p>
<p>“I’m thankful to be able to continue a long and fruitful relationship with Headspring,” said Jeffrey Palermo, Managing Partner &amp; CEO of Clear Measure.  “Companies rely on software for a competitive advantage. Our goal is to provide the clarity, measurement, and control that companies need to get the most of their software investments, while partnering with a company we know has the expertise to deliver forward thinking and beneficial long-term software solutions.”</p>
<p>Until recently, Jeffrey Palermo was the president and COO of Headspring.  He was instrumental in helping build Headspring’s team of talented developers and the alliance between the two companies leverages the capabilities of both to serve the growing software needs of companies.</p>
<p><b>About Clear Measure                                                                                                          </b></p>
<p>Clear Measure provides professional services and consulting that enable the clarity, measurement, and control businesses need to get the most from their software investments. Using a proven methodology, Clear Measure equips senior software executives and managers with the tools and knowledge to maximize ROI and reduce risk. For more information, go to <a href="http://www.clear-measure.com">www.clear-measure.com</a> or call 512-298-1232</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-24T00:00:00-06:00" pubdate data-updated="true">Jan 24<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/press/'>Press</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/no-offshoring/">
		
			No Offshoring</a>
	</h2>
	<div class="entry-content">
		<p>One of Headspring&#8217;s principle practices - which is probably not advertised nearly to the extent it should be - is that we never outsource development work. The policy was put in place early in our company history. This was right around the time we steered away from building websites for new companies and began focusing our services on delivering custom enterprise software. Sometimes it made sense to outsource, and could be more cost effective for our customers. But more often than not, it became difficult to see around corners and ensure that we were receiving quality built code.</p>
<p>We discovered the best way to create or reconstruct our clients&#8217; software is to hire the best architects, critical thinkers and code masters we could get our hands on, put them in a room together, and give them the resources they need to do great work. We refer to this collaboration as a &#8220;brain trust&#8221;. And working this way has directly affected our ability to be so successful.</p>
<h2>Looks Can Be Deceiving</h2>
<p>This morning I woke up to <a href="http://www.npr.org/blogs/thetwo-way/2013/01/16/169528579/outsourced-employee-sends-own-job-to-china-surfs-web" target="_blank">a national news story</a> about a company entrusting critical development work to a pricey developer - only to find its deluxe development package was being outsourced to a Chinese team for 1/5 of their cost.</p>
<p>The story is quite funny, actually.  The company discovered data that showed its virtual network being accessed from China. The company feared hackers had invaded the network, so they ordered an investigation from Verizon&#8217;s web security team. The VPN logs showed the originally contracted developer, while still sitting at his desk, was also accessing the network from a city in China.</p>
<p>Now, it was understood in the office that this contract developer (<a href="http://webcache.googleusercontent.com/search?q=cache:http://securityblog.verizonbusiness.com/2013/01/14/case-study-pro-active-log-review-might-be-a-good-idea/" target="_blank">the original story published on Verizon&#8217;s blog refers to him as &#8220;Bob&#8221;</a>) did great work. In fact, he was regarded as the best developer in the office, and was paid accordingly - six figures, in fact.  But after a deeper investigation, the Verizon team discovered hundreds of .pdf files detailing Bob&#8217;s communication with the outsourced firm he worked with in Shenyang China. He subcontracted the firm for 1/5 of his pay.</p>
<p>So what did Bob do while his sub-contract was hard at work? Here&#8217;s his busy schedule:</p>
<p>9:00 AM - Arrive at the office, surf Reddit.com, watch cat videos</p>
<p>11:30 AM - Take lunch</p>
<p>1:00 PM - Ebay time!</p>
<p>2:00 - ish PM - Facebook and LinkedIn updates</p>
<p>4:30 PM - End of day email to management</p>
<p>5:00 PM - Go home</p>
<h2>Who Do You Love?</h2>
<p>As it turns out, this wasn&#8217;t Bob&#8217;s first rodeo, and he didn&#8217;t invent the wheel either. Sure, he <em>delivered</em> great code, so what&#8217;s the big issue in the end? It comes down to trust.</p>
<p>We hear the same stories all the time from our prospective clients - except not usually with the same storybook &#8220;no harm done&#8221; ending that Verizon outlines in their comical case study. Nope. Usually companies aren&#8217;t aware of the security breach until there is a big problem.</p>
<p>So do yourself a favor: make absolute sure you are working with a company/contractor/development team that cares about your security and code as much as you do.</p>
<p>&nbsp;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-17T00:00:00-06:00" pubdate data-updated="true">Jan 17<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/blog/'>Blog</a>, <a class='category' href='/blog/categories/bonus/'>Bonus!</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/whittling-xunit/">
		
			Whittling xUnit</a>
	</h2>
	<div class="entry-content">
		<p>Last week, we saw how <a href="http://www.headspring.com/patrick/code-whittling/">Code Whittling</a> lets you learn about an unfamiliar open-source project, using <a href="http://www.headspring.com/patrick/whittling-rhino-licensing/">Rhino Licensing</a> as an example.  This week, we&#8217;ll walk through the process I took when whittling xUnit.  xUnit is a unit testing framework similar to NUnit.  I wanted to get a feel for how a test framework really works: how it traverses your test project to discover test cases, how it executes individual test cases, how it tallies results, and how it integrates with the TestDriven.net plugin for Visual Studio.</p>
<h2>The Whittle</h2>
<p>I started by grabbing a copy of the <a href="http://xunit.codeplex.com/SourceControl/BrowseLatest">xUnit source code on CodePlex</a>.</p>
<p>Not surprisingly, this project has a lot of test coverage.  Since code whittling is decidedly <em>not</em> about safe forward development, and since unit tests pose an obstacle to quickly whittling a project down to its essentials, the first thing I removed were all the unit tests.  It&#8217;s OK, we&#8217;re not going to make any permanent changes.  This is an exercise in quick discovery, not slow-and-steady accuracy.</p>
<p>I tend to use a console test runner and a TestDriven.Net test runner, but none of the other runners.  My next victims were the projects for the runners I don&#8217;t happen to use: xunit.gui, xunit.runner.visualstudio, and xunit.runner.msbuild.</p>
<p>Since I use the <a href="http://nuget.org/packages/Should">Should</a> assertion library, I had no need for any of xUnit&#8217;s own assertion code, allowing me to remove a huge chunk of code I had no interest in.  I deleted the <a href="http://xunit.codeplex.com/SourceControl/changeset/view/2e806844c3c1#src/xunit/Assert.cs">Assert</a> class, its usages, and the many associated exception classes.</p>
<p>I generally don&#8217;t use the [Theory] attribute in my xUnit tests, so I removed that and its usages next.  Lots of support classes for [Theory] were no longer in my way.</p>
<p>I&#8217;m more interested in how results are tallied and output to the console, and less interested in any XSLT reporting of those results, so I removed all the XSLT-dependent code.</p>
<p>Then I removed a long series of features I rarely or never use: IUseFixture, skipped tests, [AutoRollback], [AssumeIdentity], [FreezeClock], [Trace], &#8230;</p>
<p><strong>Eventually, I goofed up.</strong>  It turns out there is more multithreading code and more dynamic construction (in which a string containing the name of a class is used to instantiate that class) in xUnit than I expected.  I actually expected little or no threading/dynamic stuff, but I ended up removing too much in one step, losing something fundamental in the code path between Main() and actual invocation of a test.</p>
<blockquote><p>Lesson learned: Even when creating a throwaway clone of a project, just so I can violently destroy it, commit frequently with useful comments.  If you remove too much, you can see where you went wrong and rewind.</p></blockquote>
<p>I found that I couldn&#8217;t whittle this down quite as far as I did with Rhino Licensing.  Even with the less-used features taken out, what I was left with involved a lot of classes deferring to classes which defer to classes which defer to static helper methods.  I could have taken the time to refactor this away and boil it all down to the fundamental logic I was searching for, but I was starting to get comfortable with the class naming conventions and could find my way through it clearly enough.</p>
<p>I got a good, though incomplete, understanding of xUnit, and going back to the original code is no longer the daunting task it was before.</p>
<h2>Results</h2>
<p>Test execution is broken down into two phases.</p>
<p>For <strong>Phase 1</strong>, it builds up a tree of objects representing the test methods in the test assemblies: a TestAssembly has TestClass objects, each of which has TestMethod objects.  These are discovered and constructed via reflection.  The class EnumerateTests uses reflection to discover all the types in a given Assembly, and ultimately defers to TypeUtility.GetTestMethods(&#8230;):</p>
<p><div><script src='https://gist.github.com/4438396.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Plain old reflection walks through all the methods in the test assembly, picking out the ones that are marked as tests with the [Fact] attribute.</p>
<p>For <strong>Phase 2</strong>, it traverses the tree of tests to execute them and accumulate results.  <a href="http://xunit.codeplex.com/SourceControl/changeset/view/2e806844c3c1#src/xunit/Sdk/Commands/ClassCommands/TestClassCommandRunner.cs">TestClassCommandRunner</a> has the main execution logic.  For a given class, it processes the list of method in random order.  For each method, xUnit gets one or more ITestCommands to execute.  Each test command is invoked, giving a MethodResult which gets included in the overall ClassResult.</p>
<p>A single test command to execute, for a test identified with the [Fact] attribute, looks like this:</p>
<p><div><script src='https://gist.github.com/4438431.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>A single test is executed here via Invoke(&#8230;), which is also a part of .NET reflection.  xUnit is just asking the .NET framework to call our test method for us.  Any exceptions bubble up and cause the test to fail, including exceptions thrown by Assert methods.  If no exceptions were thrown, it returns the new PassedResult representing success.  Results are hierarchical, just like the original tree of tests: AssemblyResult, ClassResult, FailedResult, and PassedResult allow us to track results at every level that a test runner may need to report on.</p>
<p><strong>Lastly, TestDriven.NET integration:</strong> TestDriven.NET requires you to implement the following interface.  Depending on how the user invokes TD.Net, one of these three methods will be called:</p>
<p><div><script src='https://gist.github.com/4438582.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>xUnit&#8217;s TdNetRunner implements this by ultimately deferring to the same test execution code that the console runner uses.</p>
<p>I was a little surprised by the size of the project, especially the use of multithreading.  A large number of features added up to a lot of things for me to remove before I could really see the fundamental code path.  This makes me curious about how NUnit compares, so next week we&#8217;ll see what we can learn by whittling down NUnit.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-15T00:00:00-06:00" pubdate data-updated="true">Jan 15<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/get-to-know-a-developer-jose-basilio/">
		
			Get to Know a Developer: Jose Basilio</a>
	</h2>
	<div class="entry-content">
		<p><img class="alignright size-medium wp-image-6321" alt="Jose Basilio" src="http://www.headspring.com/wp-content/uploads/2013/01/photo-2-e1357940416657-224x300.jpg" width="224" height="300" />This week we welcomed Jose Basilio to the team! Jose currently lives in Houston, but he’s originally from the Dominican Republic. I was so excited to speak with him because he told me that participating in <a href="http://www.headspring.com/mary/headspring-hosts-central-texas-givecamp-to-benefit-10-local-non-profits/" target="_blank">CTX GiveCamp</a> (one of my projects last year) convinced him to look into working for us full time. In fact, Jose was on the TX Kidney Foundation team, which won CTX GiveCamp’s highest honor: the “Meg Ryan Facelift Award for Coolest UI”. I knew he was a winner. Here’s the rest of our conversation:</p>
<p>Where did you work, and what did you do before coming to Headspring?</p>
<p>I was a senior developer at Dril-Quip, Inc., a manufacturer of oil and gas drilling equipment in Houston. Prior to that, I worked in various roles in application and database administration at Compaq / HP.</p>
<p>What or who made you want to work here?</p>
<p>Throughout my career, I have worked for companies where software was a cost-center. I wanted the opportunity to work for a company where my efforts directly contribute to the bottom-line. I also wanted work along-size like-minded individuals that have a passion for learning and moving their careers forward. I believe Headspring is that company.</p>
<p>What led you to software development?</p>
<p>Computers are better than humans at performing repetitive tasks in a fast and consistent manner. I wanted to automate my day-to-day activities as a database admin. This led me to learn scripting languages, and I enjoyed that so much that moved into full-blown development.</p>
<p>What did you learn first?</p>
<p>I started by learning VBScript to create windows scripts and dynamic web pages back in the day.</p>
<p>Do you like teaching?</p>
<p>I love teaching and learning new things. The best way to truly learn and become an expert at something is to teach it.  I think that in the process of simplifying a topic in order to teach it to others, we gain clarity of mind and reach those “aha” moments in our understanding of the subject.</p>
<p>&nbsp;</p>
<p>Want to know more? Tweet <a href="https://twitter.com/jbasilio" target="_blank">@jbasilio</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-11T00:00:00-06:00" pubdate data-updated="true">Jan 11<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/blog/'>Blog</a>, <a class='category' href='/blog/categories/bonus/'>Bonus!</a>, <a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>, <a class='category' href='/blog/categories/get-to-know-a-headspringer/'>Get To Know a Headspringer</a>, <a class='category' href='/blog/categories/what-the-tech/'>What the tech?</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/whittling-rhino-licensing/">
		
			Whittling Rhino Licensing</a>
	</h2>
	<div class="entry-content">
		<p>Last week, I introduced a learning exercise called <a href="http://www.headspring.com/patrick/code-whittling/">Code Whittling</a>.  This week, we&#8217;ll walk through the process I took when whittling <a href="http://www.hibernatingrhinos.com/oss/rhino-licensing">Rhino Licensing</a>.</p>
<p>Rhino Licensing makes it easy for your application to enforce licenses.  If you&#8217;re making a application that needs to check which features the user has paid for, whether a trial has expired, etc, this is about as easy as it gets.  I recently needed to do this for a client, and James Gregory&#8217;s <a href="http://www.jagregory.com/writings/rhino-licensing/">Rhino Licensing tutorial</a> covers exactly the use case I cared about.  The tool, however, handles more than that use case.  I wanted to know how the basic idea worked, how a human-readable XML file could be tamper-proof, but I didn&#8217;t care about the other supported use cases.</p>
<h2>The Whittle</h2>
<p>I started by grabbing a copy of the <a href="https://github.com/hibernating-rhinos/rhino-licensing">Rhino Licensing source</a>.</p>
<p>GUI tools in support of a library don&#8217;t usually catch my interest.  Rhino.Licensing.AdminTool was a UI tool I didn&#8217;t need to work with for my use case, so it was the first to go.</p>
<p>Rhino Licensing can use trusted time servers like time.nist.gov when deciding whether a license&#8217;s expiration date has been reached, since malicious users might subvert expiration dates by changing their local system clock to some future date.  This feature is important, but was irrelevant to me in the short term: I wanted to know how the license files themselves work, and cared less about the details of reliable timekeeping.  I removed the class <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/SntpClient.cs">SntpClient</a>, the array of trusted servers within <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/AbstractLicenseValidator.cs">AbstractLicenseValidator</a>, and everything that depended on them.</p>
<p>There are several exception types declared, which is useful for communicating why a license might fail validation, but they didn&#8217;t help me in my quest to find out how the license files could be tamper-proof, so I phased them out in favor of generic Exception instances.  Likewise, logging is important, but it was just noise for my purposes, so I removed it.</p>
<p>The <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/LicenseType.cs">LicenseType</a> enum lists several kinds of licenses I was uninterested in.  I removed the ones I wasn&#8217;t interested in along with their usages.</p>
<p>Rhino Licensing has a server-side component, I believe to coordinate the sharing of license files across multiple machines.  Although interesting, this doesn&#8217;t have to do with the tamper-proofing of license file content, so I removed: LicensingService, ISubscriptionLicensingService, ILicensingService, DiscoveryHost, DiscoveryClient, and anything that depended on them.</p>
<p><a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/AbstractLicenseValidator.cs">AbstractLicenseValidator</a> has two child classes: <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/LicenseValidator.cs">LicenseValidator</a> for processing a license XML file, and <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/StringLicenseValidator.cs">StringLicenseValidator</a> for processing a string of XML (for instance, you may be storing your license content in a database rather than a file).  I didn&#8217;t need a refresher course on reading file content into a string, so I removed LicenseValidator and then collapsed StringLicenseValidator into the AbstractLicenseValidator base class.</p>
<h2>Results - Signing XML Documents</h2>
<p>All this left me with a better understanding of what Rhino Licensing has to offer, while whittling the project down to the few files I <em>really</em> wanted to dig into: <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/LicenseGenerator.cs">LicenseGenerator</a>, and a now-much-much-smaller version of <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/AbstractLicenseValidator.cs">AbstractLicenseValidator</a>.  The first is responsible for generating the tamper-proof XML, and the second is responsible for parsing the tamper-proof XML and deciding whether it is legitimate.</p>
<p>James Gregory&#8217;s <a href="http://www.jagregory.com/writings/rhino-licensing/">Rhino Licensing tutorial</a> first describes a prerequisite step for creating a private/public key pair:</p>
<p><div><script src='https://gist.github.com/4435588.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>The contents of these files are basically large numbers.  The numbers are related to each other, but a malicious user would not be able to guess the private one given only the public one.</p>
<p><a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/LicenseGenerator.cs">LicenseGenerator</a> is given the private one as a string to its constructor.  LicenseGenerator then generates a string of XML given a few values.  The values will all appear in plain text in the XML: name, id, expirationDate, LicenseType, and an optional set of name/value pairs specific to your needs.  The private helper method CreateDocument produces an XmlDocument containing those inputs.</p>
<p><strong>Next, the magic happens.</strong>  This simple XML document is completely open to tampering by a malicious user.  To combat our adversary, it supplements the document with an additional XML element produced by private helper method GetXmlDigitalSignature.  This method uses some .NET framework classes to take the original document and use the secret/private key to produce an encrypted version of the original weak XML document.  The new XML element basically contains yet another very large number, which corresponds with the original XML document content.  The resulting document is now tamper-proof: if a malicious user opens it and changes the expiration date to the year 2500, they would have to <em>also</em> change the big signature number to match, and <em>good luck guessing what big number corresponds with the new XML document</em>, since the malicious user doesn&#8217;t have the private key necessary to create that number quickly.  To sum up, here&#8217;s how to take an insecure XML document and make it tamper-proof with a signature:</p>
<p><div><script src='https://gist.github.com/4438155.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Once we have one of these documents, how do we read and validate them?  <a href="https://github.com/hibernating-rhinos/rhino-licensing/blob/4d77e00bfa85e8d22f966b09e340be31476afac1/Rhino.Licensing/AbstractLicenseValidator.cs">AbstractLicenseValidator</a> had been whittled down to be little more than the methods ValidateXmlDocumentLicense() and TryGetValidDocument(string licensePublicKey, XmlDocument doc).  Contrary to its name, the main thing ValidateXmlDocumentLicense does is read the original inputs from the human-readable parts of the XML file.  TryGetValidDocument does the real work, the inverse of LicenseGenerator&#8217;s digital &#8220;signature&#8221;: read the special &lt;Signature&gt; element which contains our encrypted original document, and ask the .NET framework whether it matches the rest of the document&#8217;s human-readable content:</p>
<p><div><script src='https://gist.github.com/4438179.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Creating tamper-proof yet human-readable XML files is no longer magical.  Rhino Licensing creates and validates tamper-proof license files by taking the original insecure version of the document and appending a special &#8220;content summary&#8221; element.  A malicious user would have to tamper with the human-readable part as well as the virtually-unguessable content summary in order to trick the validator, and as long as the private key is kept private, that&#8217;s certainly good-enough.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-08T00:00:00-06:00" pubdate data-updated="true">Jan 8<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/9/" class="prev">Prev</a>
    
    
        <a href="/blog/page/11/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Headspring Labs

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>