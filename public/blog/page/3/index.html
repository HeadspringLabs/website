
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Headspring Labs</title>
  <meta name="author" content="Headspring Labs">

  
  <meta name="description" content="Last week, I announced the start of a new open source project, a test framework named Fixie. This week, we&#8217;ll see how to mitigate technical &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://headspringlabs.com/blog/page/3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Headspring Labs" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Headspring Labs</a></h1>
  
    <h2>Experiments by Headspringers!</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:headspringlabs.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/strongly-typed-whiteboarding/">Strongly Typed Whiteboarding</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-13T00:00:00-05:00" pubdate data-updated="true">Mar 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last week, I announced the start of a <a href="http://www.headspring.com/patrick/insufficiently-round-wheels/">new open source project, a test framework named Fixie</a>.  This week, we&#8217;ll see how to mitigate technical risks during the early days of such a project.  In short, you do the hard work first.</p>
<p>When starting a new project, it&#8217;s easy to spend all of your time thinking about what success looks like: the awesome features you have in mind, all working together in perfect harmony, with code so clean there&#8217;s just no room for bugs.  However, there are all kinds of reasons a project could fail, and these reasons include the possibility of a technical obstacle turning the project into a nonstarter.  Early on, you&#8217;ve got to put on your Pessimist Hat and think,</p>
<blockquote><p>&#8220;What is the biggest technical challenge that, if unsolved, would make the rest of the effort worthless?&#8221;</p></blockquote>
<h2>Identify the Deal Breaker</h2>
<p>The 10,000 foot view of my plans for Fixie include the following features:</p>
<ol>
<li>Low-ceremony test fixture class discovery by default.</li>
<li>Low-ceremony test case discovery by default.</li>
<li>Simple test fixture lifecycle by default.</li>
<li>A console runner you could invoke from a build script.</li>
<li>Integration with TestDriven.NET.</li>
<li>Slick customization of the defaults: fixture discovery, case discovery, and fixture lifecycle.</li>
</ol>
<p>The first two are easy: I basically accomplished that when I <a href="http://www.headspring.com/patrick/low-ceremony-xunit/">customized xUnit</a> a while back.  I&#8217;m similarly not concerned about making a simple fixture lifecycle either, since I&#8217;ve used enough reflection to be comfortable instantiating a given Type, invoking methods on that Type, and the like.  The console runner will be a relatively small wrapper around that foundation.  Slick customization is a big, fancy feature I&#8217;d love to get to, <em>but utter failure there isn&#8217;t a deal breaker</em>.  I&#8217;d still want to use this on my own projects even if I could only leverage the simple defaults.</p>
<p>The deal breaker here is actually integration with TestDriven.NET.  Sometimes I use the ReSharper runner because it does a better job of running tests under the debugger, but GUI runners are usually overkill.  I use TD.NET because it&#8217;s simple, fast, and just fits my daily routine better.  I wouldn&#8217;t want to use Fixie on my other projects if it meant having to give up on TD.NET.  Fortunately, I found that it can work with third-party test frameworks.</p>
<h2>Create a Proof of Concept</h2>
<p>I decided that I needed to see a successful proof of concept for integration with TD.NET, before working on anything else.  It didn&#8217;t need to actually run any tests.  It just needed to prove that I could reach my own code in a meaningful way via TD.NET&#8217;s keyboard shortcuts.  Success means hitting TD.NET&#8217;s shortcut in Visual Studio, reaching my own code as a result, and then witnessing the expected output written by TD.NET.</p>
<p>I made a throw-away Solution for this proof of concept.  I didn&#8217;t know what I was doing, I was sure I&#8217;d make a bit of a mess along the way, and I didn&#8217;t want to feel any irrational pressure to keep that kind of code around as a starting point for the real thing.  I wrote one to throw away, and the key here is <em>knowing</em> this was the one to throw away.</p>
<blockquote><p>It was better than a whiteboard sketch, in that I got real feedback from the IDE at every step, but it was weaker than regular development.  All the planning and whiteboard diagrams in the world would have been irrelevant as soon as fingers met keyboard, so I dove into the implementation with the intent to learn from the activity and to discard the code afterwards.</p></blockquote>
<p>The throw-away Solution contained two projects.  The first project represented the fake implementation of my test framework&#8217;s TD.NET plugin.  The second project represented the test cases within a hypothetical consumer project.  The goal here was not to make a working plugin, but instead to prove to myself that the TD.NET integration would be technically feasable.  I wanted to discover how TD.NET behaved as I implemented that integration from scratch.</p>
<p>First, I left the fake plugin project <em>empty</em> and populated the sample consumer with a single fake test fixture:</p>
<p><div><script src='https://gist.github.com/5149250.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Before doing anything in the plugin project, I wanted to confirm the behavior of TD.NET in the case that NO test framework is in play at all.  Right-clicking on the MyTestCase method and running it showed the following output:</p>
<p><div><script src='https://gist.github.com/5149257.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Oh, right.  TD.NET has a convenient feature that it can run methods even if they are not officially recognized as test methods in a test fixture.  That can be useful to quickly try out a simple method during development, before you really have tests in place for it.  This behavior poses an interesting problem, though: <strong>how will I <em>know</em> when my proof of concept is actually being detected and used by TD.NET as a real test framework plugin?</strong></p>
<p>There are <strong>two</strong> aspects to ensuring that my proof of concept is actually playing nicely with TD.NET:</p>
<ul>
<li>When I have no test framework in play yet and I attempt to right-click the MyTestFixture class to run ALL of it, TD.NET thankfully complains: &#8220;The target type doesn&#8217;t contain tests from a known test framework or a &#8216;Main&#8217; method.&#8221;  Once I&#8217;m successful, I shouldn&#8217;t get this message anymore.</li>
<li>My initial implementation of the plugin will simply throw an exception of its <em>own</em>, surfacing in TD.NET&#8217;s output, in contrast to the above output.</li>
</ul>
<p>TD.NET includes a library, TestDriven.Framework.dll, which you can use to wire things up to your own test runner.  It contains an interface that you must implement for your plugin to be detected.  TD.NET plugs into Visual Studio to pick up on keyboard shortcuts and the like, then turns that into calls against this interface, allowing you to pick things up from there to do the actual work of running tests.</p>
<p>In the plugin project, I added a reference to TestDriven.Framework.dll and added the following class as a first pass:</p>
<p><div><script src='https://gist.github.com/5149264.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Since each method just throws an exception with a specific message, I&#8217;ll be able to prove to myself whether or not TD.NET actually found and executed the plugin.  I made the sample consumer project reference the plugin project, and attempted to run the sample test method and test fixture: no dice.  The results were the same as having no test framework in play at all!</p>
<p>There was another piece to the puzzle.</p>
<p>The TD.NET blog explains how to complete the detection of custom test runners: <a href="http://weblogs.asp.net/nunitaddin/archive/2009/11/05/testdriven-net-2-24-xcopy-deployable-test-runners.aspx">XCopy Deployable Test Runners</a>.  Over in the plugin project, I added a text file named TestDrivenPoc.dll.tdnet:</p>
<p><div><script src='https://gist.github.com/5149267.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>In Solution Explorer, I set this text file to &#8220;Copy Always&#8221;.  Now, when I rebuild the solution, the consumer gets a copy of this file right beside the similarly named DLL.  (When it comes time to deploy this to users, I&#8217;ll need to be sure to include this file along with the DLL.)  When running MyTestCase or MyTestFixture, we now see the exception thrown by our fake test framework&#8217;s TD.NET integration:</p>
<p><div><script src='https://gist.github.com/5149272.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p><div><script src='https://gist.github.com/5149273.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Fantastic!  These exceptions prove that TD.NET was able to find our plugin and call methods on it, instead of the default behavior we saw when there was no test framework in place.</p>
<p>To sum up, when creating a test framework that needs to integrate with TD.NET:</p>
<ul>
<li>Reference TestDriven.Framework.dll.</li>
<li>Implement TestDriven.Framework.ITestRunner.</li>
<li>Include a *.tdnet text file whose name matches the test framework&#8217;s DLL, and whose contents identify the plugin&#8217;s DLL and ITestRunner class. (In my case, these two DLLs were one and the same.)</li>
<li>Consumers must reference the test framework and must have the *.tdnet file present.</li>
</ul>
<h2>Eliminate Any Remaining Risks</h2>
<p>Part of the interface strikes me as odd.  Note how in the sample successful output above, we hit &#8220;RunMember&#8221; after telling TD.NET to run a single test method <strong>and</strong> after telling it to run a whole test fixture class.  I would use the word &#8220;member&#8221; to describe a method-belonging-to-a-class, but using &#8220;member&#8221; to describe a whole class surprised me.</p>
<p>I was unsure of how to really implement RunMember(&#8230;), so I wasn&#8217;t finished with the proof of concept.  With a little trial and error, I fleshed out just enough of this method to see how you can tell the difference between single-test-method execution versus whole-test-fixture execution:</p>
<p><div><script src='https://gist.github.com/5149277.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>This implementation determines whether we are running a test method or a test fixure, announces that fact in the output, and then reports success since we&#8217;re still just faking test execution.  In writing this method, I learned that MemberInfo, part of the .NET reflection API, can be used to describe class members as well as classes.</p>
<blockquote><p>The awkward wording in the TD.NET interface is in fact due to awkward naming in the .NET Framework.  I&#8217;ll want to be sure to avoid letting that complexity leak out into my own API.  Bad naming can spread like a disease.  If it posed an obstacle to my understanding ITestRunner, it would pose a similar obstacle to anyone reading Fixie&#8217;s implementation.</p></blockquote>
<p>Now, when I attempt to run my sample tests at the method or class level, I get the expected output:</p>
<p><div><script src='https://gist.github.com/5149279.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<h2>Set the Proof of Concept Aside</h2>
<p>This is a proof of concept.  I don&#8217;t actually want this code in my real Solution.  Now that I have these notes handy, it can <em>and should</em> be discarded.  I&#8217;ll grow the real implementation with more care when I&#8217;m ready to implement it.  With a little strongly-typed whiteboarding, I&#8217;ve removed the largest risk to the project and can feel free to proceed.</p>
<p>Next week, we&#8217;ll cover the nuts and bolts of setting up a new project from scratch, covering Fixie&#8217;s initial set of commits.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/meet-headspring-sam-garrison/">Meet Headspring: Sam Garrison</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-08T00:00:00-06:00" pubdate data-updated="true">Mar 8<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Born in Kentucky and raised in Austin, Sam Garrison can be found on Lake Austin on the weekends, sailing on his 12-foot Laser. After graduating from The University of Texas at Austin with degrees in government and history, he joined the army for about a year. We’re excited to introduce Sam to you!</p>
<p style="text-align: center;"><img class="size-medium wp-image-6480 aligncenter" alt="sam1" src="http://www.headspring.com/wp-content/uploads/2013/03/sam1-263x300.jpg" width="263" height="300" /></p>
<p><b>What did you do before coming to Headspring?</b></p>
<p>I worked at a pharmaceutical research company and analyzed statistics, trends, patterns, and data. I enjoy working with numbers, so joining Headspring’s Business Development department was a great fit.</p>
<p><b>What attracted you to work at Headspring?</b></p>
<p>Great corporate culture. Headspring recruits highly talented people and the opportunity to work around very intelligent people made it appealing. The job description and career progression are very straightforward and match my career goals.</p>
<p><b>How do you gauge “time well spent?”</b></p>
<p>Any time you look back and say you wouldn’t have done it differently, or doing something you enjoy that also brings long-term goodness or benefit.<em id="__mceDel"> </em></p>
<p><b>What is your role at Headspring?</b></p>
<p>I’m focused on developing business in the Houston market. I’m defining and developing the working markets and building relationships with existing and potential clients.</p>
<p><b>What do you hope to accomplish professionally and personally in the next 5 years?</b></p>
<p>I care about Headspring and am invested in the company and people. I want to help Headspring grow. I also want to grow and increase my level of responsibility.</p>
<p><b>What do you enjoy doing in your free time?</b></p>
<p>I love sports and watch ESPN a lot. Besides sailing, I play in a lacrosse league. I also enjoy playing chess, reading and all outdoor activities.</p>
<p><b>What’s a tool or gadget you can’t live without?</b></p>
<p>My headlamp. It’s invaluable when you’re in the dark. I always have it with me. I used it to change a sparkplug under the car hood the other day.</p>
<p><b>What’s a piece of wisdom or advice you live by?</b></p>
<p>I don’t believe things happen for a reason but I believe in making the best of the situation when it does happen.</p>
<p>&nbsp;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/insufficiently-round-wheels/">Insufficiently Round Wheels</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-08T00:00:00-06:00" pubdate data-updated="true">Mar 8<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When Sharon Cichelli started the <a href="http://austin.polyglotprogrammers.org">Polyglot Programmers of Austin</a>, she created the meeting format around learning-by-teaching: one of the best ways to become an expert at something is to start teaching others about it.  Surely you&#8217;ll make some glorious mistakes along the way, but you&#8217;ll be motivated to constantly fill in the gaps of your knowledge in order to keep up with yourself and your audience.</p>
<p>My weekly blog posts over the past year and a half have served the purpose of learning-by-teaching, but the subject matter has always been random.  One thing that has made this effort difficult is that my current open source projects are a little esoteric.  It&#8217;s too difficult to write an article of the form, &#8220;Here&#8217;s a problem I ran into and here&#8217;s how I solved it,&#8221; as these projects require too much background explanation each time.</p>
<p>To motivate better learning-by-teaching, I&#8217;d like to take on a new experiment: developing a new open source project from scratch, documenting my approach here each week.  To keep the material focused and more generally useful, I&#8217;ll be selecting a project that most software developers are at least familiar with.  I want to work on something immediately <em>recognizable</em>, so that we all know what success will look like at each step, yet complex enough that the engineering challenges will match those we all find on real world projects.</p>
<p>I&#8217;m going to reinvent a familiar wheel, but that&#8217;s okay.  The more I look at this wheel, the more I think it really could benefit from being reinvented.</p>
<h2>Goals</h2>
<p>The goals of this project are not limited to delivering the software.</p>
<p>My public goal for this series of articles is to help any developer feel confident that they, too, can start a new open source project.  We&#8217;ll cover things like attacking the hard problems first, prototyping, build scripts, bootstrapping, dogfooding, and publishing your work for everyone to use.  Along the way, we&#8217;ll surely run into some interesting engineering challenges, too.</p>
<p>My personal goals are twofold.  First, I want to become a better software developer, and that takes practice.  Second, I want to become better at helping others to become better software developers.</p>
<p>Documenting my progress as I go along is just an extension of the open source point of view.  Not only will the <em>source</em> be open source on GitHub, but the <em>process</em> will be open source here in these articles.</p>
<h2>The Wheel</h2>
<p>In case I haven&#8217;t been clear enough, I want to pick a problem that is <em>extremely</em> familar to software developers, but one that is nontrivial to implement.  Also, in order to add something new to the mix, it should be a problem whose state of the art has basically stagnated and could benefit from a refresh.</p>
<p>The insufficiently round wheel I&#8217;d like to reinvent is the unit test framework.</p>
<blockquote><p>
<strong>Seriously?</strong> Yes.<br />
<strong>No, really.</strong> Yes.<br />
<strong>Those have been around forever.</strong> You could say the same thing about music or turducken, but we&#8217;ve only really started to get those right in the last few years.<br />
<strong>But Patrick, that is a sufficiently round wheel and you shouldn&#8217;t be reinventing the wheel.  Do something cool instead!</strong> First, all &#8220;reinventing the wheel&#8221; remarks shall be met with a friendly &#8220;That&#8217;s kind of the point,&#8221; followed by a not-so-friendly <a href="http://www.youtube.com/watch?v=fRiiiKA1xUI#t=13s">EPIC EYE-ROLL</a>.  Second, I think we really can add something cool to the mix.</p>
<p>If you must, think of it as a big code review of the current state of the art, followed by some advice on building <em>any</em> old open source project you have in mind.
</p></blockquote>
<h2>NUnit and xUnit: Constructive Criticism</h2>
<p>I have happily used NUnit for several years on several projects.  I&#8217;m using it on my current project at Headspring.  It&#8217;s excellent.  Use it.  I have happily used xUnit for several years on several projects.  I&#8217;m using it on my current open source projects.  It&#8217;s excellent.  Use it.</p>
<p>Still, these are complex systems, so there is always room for constructive criticism.</p>
<p><strong>NUnit has a complex test fixture lifecycle.</strong>  You can have code run before and after each fixture, and before and after each test case.  You specify these setup and teardown actions via [Attributes].  One instance of your fixture class is constructed and shared across the test cases, in order to support the fixture-level setup and teardown.</p>
<p>I&#8217;ve run into a lot of frustrating surprises with this lifecycle.  First, I couldn&#8217;t tell you exactly how these attributes behave in the presence of inheritance (in fact, I believe the rules changed a few times throughout the history of NUnit).  Second, I have seen this behave differently across different <em>test runners</em>.  It&#8217;s pretty jarring to find your SetUp methods blatantly ignored.  <strong>The lifecycle is complex.  I lack control over it, and I lack insight into it when things go weird.</strong></p>
<p>xUnit was a reaction to NUnit, and it has a much simpler fixture lifecycle.  You get one instance of the fixture class <em>per test case</em>, a regular constructor is used for setup, a regular Dispose() is used for teardown, and if you really really want fixture state, you can still do that using an interface dedicated to that purpose.  I like the simplicity of using already-available language concepts like constructors and interfaces for these lifecycle steps.  I never get confused when my xUnit fixture classes take part in inheritance.</p>
<blockquote><p>I find that when fixture-wide state is downplayed like it is in xUnit, <em>I don&#8217;t miss it at all</em>.  When I use NUnit, on the other hand, I use [TestFixtureSetUp] all the time.  Once you open the door to a little complexity, vagabonds and feral cats are free to walk right in.</p></blockquote>
<p>xUnit is meant to be more customizable with regard to how fixtures and test cases are discovered, but <strong>the means of customization is opinionated</strong>.  I&#8217;ve had some success customizing xUnit in the past, but I ran into two problems: I still had to put an attribute on each of my fixture classes, and the means of customization is an <a href="http://www.headspring.com/patrick/low-ceremony-xunit/">ISP violation</a>.</p>
<p>Okay, so it was a little hard to customize, buy why is it bad that I still had to put an attribute on my fixture classes?  I actually have a use case in mind for one of my other projects, in which some test fixtures would originate from folders of plain text files rather than C# classes.  If my fixture isn&#8217;t also a class, <em>where do I put xUnit&#8217;s required class attribute</em>?  <strong>I want to have total control over the means of discovering test fixtures and test cases.</strong></p>
<h2>Degrees of Freedom</h2>
<p>Regardless of the test framework I use, I use the Should assertion library.  Its creator recognized that assertion libraries have no business being tied to a single test framework.  Once that concept was plucked out of the test framework&#8217;s responsibilities, developers gained an extra degree of freedom: you can change your assertion library without having to change your test framework, and you can change your test framework without having to change your assertions.</p>
<blockquote><p>I&#8217;m thinking about switching to Shoudly.  <a href="http://shouldly.github.com/">Its error messages are amazing.</a>  How does that even <em>work</em>!?</p></blockquote>
<p>Ensuring the freedom to make changes is vital to successful software development, which raises an important question: if assertion libraries have no business being a part of a test framework, and plucking them out gives us a new degree of freedom, then what <em>else</em> are test frameworks mistakenly doing which should <em>also</em> be plucked out?</p>
<h2>Fixie</h2>
<p>Aside from providing reasonable defaults, I think that test frameworks have no business owning test fixture discovery, test case discovery, or the test fixture lifecycle.  The reasonable defaults should be enough for the 90% of use cases, but it should get completely the heck out of my way for the other 90%.</p>
<p>If we pluck those responsibilities out, what&#8217;s left?  Test frameworks should only do the monotonous parts: orchestration of test execution, deferring to you for advice on discovery/lifecycle decisions, accumulating results, and reporting those results to whatever test runner is in play.  It should include a console test runner at a minimum, but test running should also be available as a library so that other runners like a GUI runner, ReSharper plugin, TestDriven.NET runner, or the like could be developed independently.</p>
<p>I&#8217;d like to announce <a href="https://github.com/plioi/fixie">Fixie</a>, a test framework with the goals of having low-ceremony defaults, and extra degrees of freedom around the test lifecycle.  We&#8217;ll see this project grow here over the next few months.</p>
<blockquote><p>A <a href="http://en.wikipedia.org/wiki/Fixed-gear_bicycle">fixie</a> is what you get when you start with a bike and remove everything that isn&#8217;t a bike.  I want Fixie to be what&#8217;s left when you start with a test framework and remove everything that isn&#8217;t a test framework.</p></blockquote>
<p><strong>Low-ceremony defaults:</strong> No required attributes, no required inheritance.  A test fixture is a class in your test assembly whose name ends in Tests.  A test case is any public method in one of those classes.  I will likely include an answer to NUnit&#8217;s <a href="http://nunit.org/index.php?p=testCaseSource&r=2.6.2">[TestCaseSource]</a>, but only if I can keep it similarly low-ceremony.  Like xUnit, you&#8217;ll get one fixture instance per test case.</p>
<p><strong>Degrees of freedom:</strong>  If the defaults aren&#8217;t enough, I want you to be able to customize the test fixture and test case discovery steps, as well as customize the test fixture lifecycle itself.  Making this customization <em>easy</em> will be challenging, but fun.</p>
<p>Next week, we&#8217;ll tackle a proof-of-concept for the highest-risk requirement: the must-have integration with TestDriven.NET.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/you-need-solutions-not-surprises/">You Need Solutions, Not Surprises</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-01T00:00:00-06:00" pubdate data-updated="true">Mar 1<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="slide-content">
<h1>&#8220;You need solutions, not surprises</h1>
<p>Let our expert enginers pave the way.&#8221;</p>
<div class="button-wrap"><a class="button" href="/contact">Get in touch</a></div>
</div>
<div class="slide-media">
<div style="max-width: 342px;">
<div onclick="thevid=document.getElementById('thevideo'); thevid.style.display='block'; this.style.display='none'; "><img style="cursor: pointer;" alt="" src="http://www.headspring.com/wp-content/themes/headspring/images/slide-video-placeholder.jpg" /></div>
<div id="thevideo" style="display: none;"><iframe src="http://www.youtube.com/embed/SMVXAurJHtA?rel=0;showinfo=0;enablejsapi=1" height="235" width="342" frameborder="0"></iframe></div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/powerful-design-long-term-vision/">Powerful Design, Long Term Vision</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-01T00:00:00-06:00" pubdate data-updated="true">Mar 1<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="slide-content">
<h1>&#8220;Powerful design, long-term vision:</h1>
<p>At Headspring, we look at how your software can be used in the real world, and what sort of impact it will have. Learn more about the playbook management system we built for First Down Technologies.&#8221;</p>
<div class="button-wrap"><a class="button" href="/success-stories">View our portfolio</a></div>
</div>
<div class="slide-media"><img alt="" src="/wp-content/themes/headspring/images/football-ipad.png" /></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/meet-headspring-joe-lockbaum/">Meet Headspring: Joe Lockbaum</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-01T00:00:00-06:00" pubdate data-updated="true">Mar 1<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p style="text-align: left;">In January, we welcomed Joe Lockbaum to the Business Development department of the Headspring Team. Joe moved to Austin from New Jersey in the summer of 2012 for our wonderful weather &#8211; “You don’t have to shovel heat!” Moving with his wife, Joe was excited to continue his career in the great Texas economy and in a great city. In addition to working at Headspring, Joe is in the process of starting a gym.</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/meet-headspring-joe-lockbaum/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/creating-windows-installers-with-the-wix-toolset-part-6/">Creating Windows Installers With the WiX Toolset Part 6</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-28T00:00:00-06:00" pubdate data-updated="true">Feb 28<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><address>This article is part of a series exploring how to create installers for Windows software.  Here&#8217;s the complete contents of the series.</address>
<address><a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-01/">Part 1 – What Kinds of Software Projects Benefit From an Installer?</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-02/">Part 2 – An Overview Of Windows Installer and its Features</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-03/">Part 3 – Tooling Options for Building Installers</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-04/">Part 4 – The Windows Installer Runtime Sequence</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-5/">Part 5 – The Contents of an MSI</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-6/">Part 6 – The Structure of a WiX File</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-7/">Part 7 – Generating an MSI Package From Your WiX</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-8/">Part 8 – Troubleshooting Installer Runtime Problems</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-summary/">Part 9 - Summary</a><br />
</address>
<p><br/></p>
<h2>Summary</h2>
<p>This post is a companion to the previous post in Part 5 - it shows and explains the structure of the WiX file that was used to generate the MSI.</p>
<h2>Tooling and References For Editing WiX Files</h2>
<p>Since the name of the toolkit is &#8220;Windows Installer in XML&#8221;, you probably won&#8217;t be terribly surprised to find out that the source files you edit are&#8230;wait for it&#8230;XML. This means you can author and edit in your favorite XML editor of choice, whether that&#8217;s Notepad++, some incredibly expensive specialty tool like Altova XML Spy, or Visual Studio. If you use Visual Studio and you&#8217;ve installed WiX on your local machine, you can leverage the included Votive project types to get Intellisense in Visual Studio.</p>
<p>[caption id=&#8221;attachment_6409&#8221; align=&#8221;alignnone&#8221; width=&#8221;582&#8221;]<a href="http://www.headspring.com/wp-content/uploads/2013/02/votiveIntellisense.png"><img class=" wp-image-6409 " alt="Picture of editing with Visual Studio and Intellisense supplied by Votive" src="http://www.headspring.com/wp-content/uploads/2013/02/votiveIntellisense-970x562.png" width="582" height="337" /></a> Visual Studio Intellisense with Votive[/caption]</p>
<p>There&#8217;s reference documentation for the schema at <a href=" http://wix.sourceforge.net/manual-wix3/schema_index.htm">SourceForge</a>. The first link is for the WiX schema itself, and there are other schema references for the various extensions that are available.</p>
<h2>The Complete Hello World</h2>
<p><div><script src='https://gist.github.com/5014691.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<h2>Dissecting the Elements</h2>
<p>Line 3 is pretty straightforward: declare our root Wix element and specify the namespace. No that isn&#8217;t a typo at the end; the namespace really doesn&#8217;t have an x at the end of it. I have no idea why.</p>
<p>Line 5 declares our Product for the installer (recall Product has a cardinality of 1). Some of the supporting attributes like Manufacturer, Name, and Version will show up in the Add Program and Features list for Windows.</p>
<p>Line 12 defines the Package (also cardinality of 1), which is the installer itself. Attributes here will show up in the properties of the MSI file.</p>
<p>Line 19 introduces the concept of Media, which wasn&#8217;t discussed in the MSI examination. Windows Installer has a profuse amount of options for the physical layout of the files to be deployed, including things like spanning multiple DVDs (or floppies - <a href="http://superuser.com/questions/231273/what-are-the-windows-a-and-b-drives-used-for">remember those?</a> The need for this has fallen by the wayside as most software is downloaded from the internet or an internal network these days. In this example, we only have one physical media target, and the EmbedCab attribute will package all the deployables into the MSI directly since we don&#8217;t need disc spanning.</p>
<p>Line 21 defines our target directory structure. Note it&#8217;s nested. I&#8217;m not going to discuss it exhaustively, but will point out a few interesting things. Line 22 specifies we&#8217;re installing into this machine&#8217;s Program Files directory, and line 23 is the INSTALLDIR, which is our root target directory. More sophisticated installers will allow the user to specify their own directory and replace the value of INSTALLDIR.</p>
<p>Line 24 defines our one and only component. Recall from the previous post its possible for a component to have more than one deployable in it, but there are advantages to having a component for every file. Components have a unique ID to identify them.</p>
<p>In this example we&#8217;ve associated our component with a target directory by simply nesting it under the desired directory. This works for simple scenarios, but if you have more than one target directory for your product or if your code generating your component definitions, it might be easier to declare the directory structure and components separately and use the DirectoryRef attribute on the component to make the association.</p>
<p>Line 25 contains a file that is part of this component. The name attribute is what the file will be called when it is placed on the target file system, and the source attribute specifies where to get the file when compiling the MSI package.</p>
<p>Line 26 does what you hopefully would guess; it removes the installation folder from the machine when the component &#8216;MainExecutable&#8217; gets uninstalled.</p>
<p>Line 32 finishes things out by declaring our single feature (although you&#8217;ll recall there could be multiple Features in a Product), and associating our component with it.</p>
<h2>Tying It All Together</h2>
<p>So we have:</p>
<ul>
<li>File HelloWorld.exe containing our executable</li>
<li>Component MainExecutable containing the HelloWorld.exe File</li>
<li>Directory INSTALLDIR (which itself is a subdirectory) associated with the MainExecutable Component</li>
<li>Feature called Complete containing the MainExecutable Component</li>
<li>Product that contains the Complete Feature (this is implied and doesn&#8217;t have to be explicitly defined)</li>
</ul>
<p>All of this maps neatly to the MSI we took apart in the <a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-05/">last post</a>. In the next installment, we&#8217;ll look at the process for actually turning WiX into an MSI.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/graphiti/">Graphiti</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-27T00:00:00-06:00" pubdate data-updated="true">Feb 27<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Back in college, I stumbled across a great tool called <a href="http://www.graphviz.org/">GraphViz</a>.  I used it to generate class diagrams from the source of a PHP application I was working on.  More recently, I&#8217;ve found it useful again for visualizing the <em>runtime</em> relationships between objects.  GraphViz can turn a plaintext description of relationships into a graph image.  Not &#8220;graph&#8221; as in &#8220;charts and graphs&#8221;, but &#8220;graph&#8221; as in &#8220;computer science graph&#8221;.  Nodes and edges:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/02/simple.png"><img src="http://www.headspring.com/wp-content/uploads/2013/02/simple.png" alt="simple" width="179" height="251" class="aligncenter size-medium wp-image-6425" /></a></p>
<p>Today, we&#8217;ll see how to easily generate images like this.  Along the way, we&#8217;ll see an interesting use case for anonymous objects.</p>
<h2>The Dot File Format</h2>
<p>The image above can be generated from the following text file, using a GraphViz tool called dot.exe.  Note the use of the word &#8216;digraph&#8217;.  A graph is anything made up of nodes and edges; a digraph is a graph where the edges have <em>di</em>rection from a source node to a destination node.</p>
<p><div><script src='https://gist.github.com/5014220.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>To create the image from the dot file, run the command: <code>dot.exe Simple.dot -Tpng -o Simple.png</code>.</p>
<p>The dot file format supports a lot of options.  For instance, we can customize the original dot file like so:</p>
<p><div><script src='https://gist.github.com/5014224.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Optional attributes appear in square brackets.  Here, we give one of our edges a label, alter the colors, and change one of the nodes from an ellipse to a box:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/02/fancy.png"><img src="http://www.headspring.com/wp-content/uploads/2013/02/fancy.png" alt="fancy" width="179" height="275" class="aligncenter size-full wp-image-6424" /></a></p>
<p>One can imagine generating these dot files programmatically with a StringBuilder.  Doing so would be a little monotonous, especially when the optional attributes like shapes and colors are included.  You have to busy yourself with the dot format&#8217;s quoting rules as well as C#&#8217;s quoting rules.  Even when you succeed, you&#8217;ll be left with some ugly code.  I&#8217;d much rather generate the above two dot files like so:</p>
<p><div><script src='https://gist.github.com/5014233.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p><div><script src='https://gist.github.com/5014237.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<h2>Implementing the Digraph Class</h2>
<p>First, it&#8217;ll be handy to define an extension method to apply the dot quoting rules to any .NET value.  The double-quote character is special in dot files and must be preceded with a slash.  Of course, double-quotes and slashes are also meaningful in C# strings, so we have to double-escape these in the substitution:</p>
<p><div><script src='https://gist.github.com/5014242.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Next, take a look at the way the optional parameters were supplied in the earlier code sample: <code>new { label = 1, color="red" }</code>.  This is an anonymous object.  It creates an instance of a class whose name we never see, with read-only properties named &#8220;label&#8221; and &#8220;color&#8221;.  We pass this to a method that doesn&#8217;t know what type is being passed to it, but that&#8217;s OK because we can use reflection to inspect such an object.  Here&#8217;s a helper that can look at these anonymous objects and turn them into an equivalent dictionary, whose ToString produces the dot syntax for attributes:</p>
<p><div><script src='https://gist.github.com/5014245.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>I <em>could</em> have instead provided a real named class with all the possible dot properties already defined.  Doing so would be useful as it would give the developer statement completion suggestions, but the <a href="http://www.graphviz.org/doc/info/attrs.html">dot file format is actually quite extensive</a>.  In this case, it&#8217;s a very reasonable tradeoff to use anonymous objects and reflection for these node and edge attributes.  Even with statement completion, you&#8217;d find yourself frequently looking up details in the documentation anyway, so the return on investment would be ridiculous.</p>
<p>We can represent a single node in the graph like so:</p>
<p><div><script src='https://gist.github.com/5014249.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>An Edge is defined by the two Nodes it connects:</p>
<p><div><script src='https://gist.github.com/5014253.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Armed with all of the above classes, we can finally implement the Digraph class with ease:</p>
<p><div><script src='https://gist.github.com/5014257.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<h2>Criticism</h2>
<p>Since the scope of this sample program is <em>entirely</em> devoted to generating the dot file format, I don&#8217;t mind the fact that I mixed state (node and edge definitions) with presentation (string formatting in each ToString override).  An earlier implementation put all of the string formatting in the Digraph class, but it was fairly ugly.  If the requirements expanded such that we needed to use the node/edge structure for things in addition to presentation in dot format, I would want to move all string formatting out of the Node, Edge, and Digraph classes, having a dedicated class just for traversing a Digraph to produce a dot file.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/creating-windows-installers-with-the-wix-toolset-part-5/">Creating Windows Installers With the WiX Toolset Part 5</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-26T00:00:00-06:00" pubdate data-updated="true">Feb 26<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><address>This article is part of a series exploring how to create installers for Windows software.  Here&#8217;s the complete contents of the series.</address>
<address><a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-01/">Part 1 – What Kinds of Software Projects Benefit From an Installer?</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-02/">Part 2 – An Overview Of Windows Installer and its Features</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-03/">Part 3 – Tooling Options for Building Installers</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-04/">Part 4 – The Windows Installer Runtime Sequence</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-5/">Part 5 – The Contents of an MSI</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-6/">Part 6 – The Structure of a WiX File</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-7/">Part 7 – Generating an MSI Package From Your WiX</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-part-8/">Part 8 – Troubleshooting Installer Runtime Problems</a><br />
<a href="http://www.headspring.com/nolan/creating-windows-installers-with-the-wix-toolset-summary/">Part 9 - Summary</a><br />
</address>
<p><br/></p>
<h2>Summary</h2>
<p>This post discusses what an MSI is, We&#8217;ll use a Microsoft SDK tool called Orca to examine what the internal structure looks like.  We&#8217;ll also talk about how the internal structure maps to Windows Installer concepts.  While this post is not about WiX directly, authoring in WiX requires a good understanding of these internal structures and how they interconnect.</p>
<h2>The Contents of an MSI</h2>
<p>If you&#8217;ve installed several software applications like Office or Halo on your computer, chances are you&#8217;ve come across a file with type of MSI.  MSI stands for Microsoft Installer, and is the primary package type that Windows Installer consumes to install a product.</p>
<p>There are other file types used by Windows Installer, but MSI is the only &#8220;required&#8221; type for making an installer.  I&#8217;m not going to discuss the other types, but you can find out more about them <a href="http://msdn.microsoft.com/en-us/library/aa372842.aspx">here</a>.</p>
<p>For our dissection we&#8217;re going to use an MSI that installs a single file - HelloWorld.exe.  Here&#8217;s the installer:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/msi.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="msi" alt="msi" src="http://www.headspring.com/wp-content/uploads/2013/01/msi_thumb.png" width="244" height="83" border="0" /></a></p>
<p>The installer has no user interface.  This is what happens when you double click the MSI to install it:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/installing.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="installing" alt="installing" src="http://www.headspring.com/wp-content/uploads/2013/01/installing_thumb.png" width="244" height="94" border="0" /></a></p>
<p>What happens next is the window changes to say &#8220;Please wait while Windows configures Edgewolf HelloWorld&#8221; with a progess bar, and then performs the installation and closes.  This happens so fast I couldn&#8217;t get a screenshot of it before it disappeared.  After we run the installer, we have a new entry in Programs and Features that looks like this:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/programsAndFeatures.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="programsAndFeatures" alt="programsAndFeatures" src="http://www.headspring.com/wp-content/uploads/2013/01/programsAndFeatures_thumb.png" width="244" height="58" border="0" /></a></p>
<p>And we can find our installed program here:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/installed.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="installed" alt="installed" src="http://www.headspring.com/wp-content/uploads/2013/01/installed_thumb.png" width="244" height="83" border="0" /></a></p>
<p>It doesn&#8217;t get much simpler then that, right?</p>
<h2>MSI Internal Structure</h2>
<p>It&#8217;s interesting how trends in software development affect technical implementations.  For example, the programming language Java was rising to prominence around the same time the XML file format was being widely touted as THE way to store data for a variety of reasons.  As a result, Java Enterprise Edition (J2EE) relies heavily on XML files, to the point that I&#8217;ve heard jokes that enterprise Java development consists of writing one line of code and editing twenty XML files.</p>
<p>Windows Installer is no different, and its source of large inspiration is relational databases.  An msi package is, quite literally, a database file with tables and rows in it.  Here&#8217;s a partial schema diagram:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/payloadTables.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="payloadTables" alt="payloadTables" src="http://www.headspring.com/wp-content/uploads/2013/01/payloadTables_thumb.png" width="244" height="111" border="0" /></a></p>
<p>Since an installer is for a single product, there&#8217;s dedicated table for that.  But a product like Microsoft Office does have multiple features such as Word, Excel, and PowerPoint.  Large features will typically be composed of a collection of subfeatures that can be installed or not installed and still have a working feature.  Examples of subfeatures for Word would be items like spellcheck, or clipart.</p>
<p>Features and subfeatures are &#8220;above the water&#8221; concepts in the way that they are exposed directly to the person using the installer.  The user sees them and has a chance to choose what features they do or do not want.</p>
<p>Features are composed of one or more components.  Components are tangible items like files, start menu shortcuts, and registry entries.  Components are &#8220;below the water&#8221; in the sense that they aren&#8217;t meant to be exposed to users.  When you&#8217;re installing Word, you could care less that you&#8217;re getting the files winword.exe, wordcnv.dll, wordcnvpxy.cnv&#8230;.well you get the idea.  Components are linked to a directory where they are installed, and are composed of one or more files.  Because the directory link is at the component level, obviously all of the files in the component need to target the same directory.</p>
<p>Components are tied to features with a linking Feature Component table.</p>
<p>In addition to the payload tables we just looked at, an MSI also has sequence tables that instruct Windows Installer what steps to execute and in what order.  There are a number standard actions included in Windows Installer such as calculating the disk space needed to perform the installation.  It&#8217;s also possible to write your own custom actions, I plan on talking about that in a later post.</p>
<h2>Installing Orca</h2>
<p>Microsoft provides a free tool called Orca that can be used to examine an MSI file.  It isn&#8217;t part of Windows, but it&#8217;s included with the Windows 7 SDK.  You can get an ISO of the Windows 7 SDK <a href="http://www.microsoft.com/en-us/download/details.aspx?id=8442">here</a> and the Windows 8 SDK is available <a href="http://msdn.microsoft.com/en-us/windows/hardware/hh852363.aspx">here</a>.</p>
<p>Once you&#8217;ve installed the SDK, you can find an installer for Orca in the Bin directory (something similar to C:\Program Files\Microsoft SDKs\Windows\v7.1\Bin).  Run the installer, and then you&#8217;ll have Orca in your start menu.</p>
<h2>Examining the Hello World MSI</h2>
<p>Start Orca.  Click File..Open, and open the MSI you want to load.  Here’s what you’ll see:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/msiTablesInOrca.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="msiTablesInOrca" alt="msiTablesInOrca" src="http://www.headspring.com/wp-content/uploads/2013/01/msiTablesInOrca_thumb.png" width="244" height="179" border="0" /></a></p>
<p>In addition to tables, the installer stores some nonrelational information in a Summary Stream.  You can view this by clicking &#8220;View..Summary Information&#8221;.  Most of it is product related, but the target architecture (32bit or 64bit) is also stored here.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/summaryStreamInOrca.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="summaryStreamInOrca" alt="summaryStreamInOrca" src="http://www.headspring.com/wp-content/uploads/2013/01/summaryStreamInOrca_thumb.png" width="229" height="244" border="0" /></a></p>
<p>Looking at the feature table, we see this installer only has one feature - Complete (as in a complete install).</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/tableFeature.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="tableFeature" alt="tableFeature" src="http://www.headspring.com/wp-content/uploads/2013/01/tableFeature_thumb.png" width="244" height="53" border="0" /></a></p>
<p>The FeatureComponent table links one component to our feature, the component called MainExecutable.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/tableFeatureComponent.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="tableFeatureComponent" alt="tableFeatureComponent" src="http://www.headspring.com/wp-content/uploads/2013/01/tableFeatureComponent_thumb.png" width="244" height="75" border="0" /></a></p>
<p>Heading over to the component table, we see MainExecutable, and it targets the INSTALLDIR for the directory.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/tableComponent.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="tableComponent" alt="tableComponent" src="http://www.headspring.com/wp-content/uploads/2013/01/tableComponent_thumb.png" width="244" height="54" border="0" /></a></p>
<p>The INSTALLDIR is going into an Edgewolf HelloWorld subdirectory under Program Files.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/tableDirectory.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="tableDirectory" alt="tableDirectory" src="http://www.headspring.com/wp-content/uploads/2013/01/tableDirectory_thumb.png" width="244" height="71" border="0" /></a></p>
<p>So where&#8217;s the actual exe?  In the File table, and we see its linked to the MainExecutable component.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/tableFile.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="tableFile" alt="tableFile" src="http://www.headspring.com/wp-content/uploads/2013/01/tableFile_thumb.png" width="244" height="54" border="0" /></a></p>
<p>I didn&#8217;t mention it earlier, but there&#8217;s also a Property table that&#8217;s a catch-all name value pair collection.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/tableProperty.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="tableProperty" alt="tableProperty" src="http://www.headspring.com/wp-content/uploads/2013/01/tableProperty_thumb.png" width="244" height="170" border="0" /></a></p>
<p>The sequence tables instruct Windows Installer in what steps to take to run the installer.  Recall that there are two install stages (the UI stage and the Execution stage).  There are tables for each, and looking at the pictures below we can see the difference between the two:</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/01/installUiSequence.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="installUiSequence" alt="installUiSequence" src="http://www.headspring.com/wp-content/uploads/2013/01/installUiSequence_thumb.png" width="244" height="115" border="0" /></a><a href="http://www.headspring.com/wp-content/uploads/2013/01/installExecuteSequence.png"><img style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="installExecuteSequence" alt="installExecuteSequence" src="http://www.headspring.com/wp-content/uploads/2013/01/installExecuteSequence_thumb.png" width="244" height="191" border="0" /></a></p>
<p>That&#8217;s enough for this post.  Now we have a solid understanding of the basic building blocks in an installer package.  In the next post we&#8217;ll take a look at the WiX that generated this MSI.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/headspring-ceo-finalist-for-austin-under-40-awards/">Headspring CEO Finalist for Austin Under 40 Awards</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-25T00:00:00-06:00" pubdate data-updated="true">Feb 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p style="text-align: left;" align="center"><i>Dustin Wells, Founder &amp; CEO of Headspring, Nominated for Austin Under 40 Awards for Technology and Sciences</i></p>
<p><b> </b></p>
<p><b>AUSTIN, Texas – (Feb. 22, 2013) –</b> Dustin Wells, founder and CEO of leading custom software development company Headspring, was honored as a top five finalists for the <a href="http://www.austinunder40.org/" target="_blank">2013 Austin Under 40 Award</a> for excellence in technology and sciences.</p>
<p>Austin Under 40 Awards, by the Austin’s Young Women’s Alliance and Young Men’s Business Alliance, honors the best and brightest young professionals in Austin. Nominees are recognized for both their professional achievements and considerable contributions to the community.</p>
<p>“I was thrilled to be nominated,” said Dustin Wells, CEO of Headspring. “Headspring’s growth and success is representative of the hard work of our entire team.”</p>
<p>Last year, Headspring achieved a 67 percent growth in revenue. With more than 35 employees, the company expects to exceed 60 by the end of the year.  Recently, the company announced its move into the Houston market and plans to launch Headspring Mobile in the spring.</p>
<p>“Our team is our best asset. We put a lot of focus on the trajectory of their career and that strong and supportive culture is reflected in the results of our work, and our excellent client relationships,” said Wells.</p>
<p>Headspring is a leader in its industry and has achieved over a 95 percent success rate in an industry where 42 percent is standard. Through rigorous work and seamless communications with clients, the company delivers software solutions with no surprises that are reliable and effective.</p>
<p>&nbsp;</p>
<p><b>About Headspring:</b></p>
<p>Headspring delivers custom business applications to help growing companies. The Austin-based company has proudly served Texas businesses since 2001. Headspring is committed to helping companies compete in their markets by delivering custom business applications for growing companies. Headspring provides customers with scalable custom applications to fit business specific needs to enable continued growth. In 2009, the company was named #127 on Inc. 500, the exclusive ranking of the nation’s fastest-growing private companies. For more information, go to <a href="http://www.headspring.com/">www.headspring.com</a> or call (877) 459–2260.</p>
<p align="center">###</p>
<p align="center">
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/dry-test-inheritance/">DRY Test Inheritance</a>
      </li>
    
      <li class="post">
        <a href="/blog/the-sincerest-form-of-flattery/">The Sincerest Form of Flattery</a>
      </li>
    
      <li class="post">
        <a href="/blog/fixies-life-bicycle/">Fixie&#8217;s Life Bicycle</a>
      </li>
    
      <li class="post">
        <a href="/blog/test-discovery/">Test Discovery</a>
      </li>
    
      <li class="post">
        <a href="/blog/enabling-change/">Enabling Change</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/HeadspringLabs">@HeadspringLabs</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'HeadspringLabs',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Headspring Labs -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
