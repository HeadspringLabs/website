
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Headspring Labs</title>
	<meta name="author" content="Headspring Labs">

	
	<meta name="description" content="There are choices to be made when running a business. Where to allocate your resources, especially cash resources, ranks among the top. Determining &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Headspring Labs" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Headspring Labs</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:headspringlabs.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/HeadspringLabs" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/HeadspringLabs" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:headspringlabs.com">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/is-an-investment-in-updating-our-software-systems-wise/">
		
			Is an Investment in Updating Our Software Systems Wise?</a>
	</h2>
	<div class="entry-content">
		<p>There are choices to be made when running a business. Where to allocate your resources, especially cash resources, ranks among the top. Determining if updating a legacy system, that is getting you by, is worth the investment can be a struggle. Is it enough of a priority? What risks are associated with updating to a newer technology? As well as what risks are there with not updating an aging technology?</p>
<p>As consultants we have helped many clients and prospective clients determine the value of updating their systems. There is not always a need to update. With our 10 years of experience, we have gotten a nice rhythm down for helping businesses decide if investing in a new business application is the best move for them. We compiled a list of questions in a <a href="http://www.headspring.com/wp-content/uploads/2013/02/Investing-in-Software-Quick-Reference-Guide-V2.pdf" target="_blank">quick reference guide</a> to help you and your team determine if updating your systems is a good move.</p>
<p>If you have been trying to convince your decision maker to allocate resources in new business systems, this is the tool to help make your case. It covers the following topics:</p>
<ul>
<li>If your system is business critical</li>
<li>Is the system at risk and should it change</li>
<li>What benefits you will gain with newer technology</li>
<li>How much updating a system might cost</li>
</ul>
<p><a href="http://www.headspring.com/wp-content/uploads/2013/02/Investing-in-Software-Quick-Reference-Guide-V2.pdf">Download the quick reference guide</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-10-20T00:00:00-05:00" pubdate data-updated="true">Oct 20<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/bonus/'>Bonus!</a>, <a class='category' href='/blog/categories/what-the-tech/'>What the tech?</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/why-generation-x-outgrew-the-mullet-and-how-were-preparing-for-the-future/">
		
			Why Generation X Outgrew the Mullet and How We’re Preparing for the Future</a>
	</h2>
	<div class="entry-content">
		<p>I was a teen of the 80s, and I have fond memories of that time in my life. The creation of MTV, fashion, music and even the TV shows I watched. However, others might view this as a time of bad hair, horrible fashion and terrible music. I lived through the Reagan Era and Challenger disaster and watched the Berlin Wall come down. I’m part of Generation X, those born around 1960-1976.</p>
<p>The newly conservative age group, 16 percent (about 50,000 people) of the U.S. population in 2009, that was concerned with creating successful futures for ourselves as they focused on college and careers took their world to new heights of material wealth and eventually personal stress. However, the shift in priorities from the social revolutions that captured the attentions of our counter-cultured parents of the baby boom generation also had a huge effect on family values.</p>
<p>My generation, Generation X, witnessed the divorce rate double as our parents embraced the concept as socially acceptable. The effects of social changes led Generation X to focus on careers first and families later. The new path in life, however, has led to a double-role situation unseen by previous generations. Generation X emphasized career first, and therefore, got married later and had children even later than all previous generations – I think I might have been the exception to this rule. I got married when I was in college. Now, many X’ers are busy taking care of their young children and spouses, as well as their parents who have grown old and need their help now, too.</p>
<p>Although I’m not at the point of needing to help my parents yet, I’ve seen and heard how becoming a parent to your parent can be an emotional wrenching process. According to an AARP study, an estimated 34 million Americans serve as unpaid caregivers for other adults, usually elderly relatives, and that they spend an average 21 hours a week helping out. In addition, millions more adult children are calling regularly, flying into town every few weeks or months or just stopping by to take Mom or Dad to the doctor. Also, there are big decisions that sometimes have to be made – from living arrangements, medical decisions, legal rights, etc. and all of this can have a strain on the family. Although most of us would view this as a minor sacrifice or no sacrifice at all, it still can have a physical, financial and emotional toll.</p>
<p>As a Gen X’er, I’ve been thinking more about how best to prepare for this – especially since my wife and I have both of our parents to worry about. Have you been planning? Are you currently in a dual-role of taking care of your family and your aging parents?</p>
<p>As for the mullet, well, isn’t it obvious why we stopped that trend?</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-10-14T00:00:00-05:00" pubdate data-updated="true">Oct 14<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/bonus/'>Bonus!</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/jeffrey-palermocoo-of-headspring-opens-up-on-pluralcast/">
		
			Jeffrey Palermo,COO of Headspring Opens Up on Pluralcast</a>
	</h2>
	<div class="entry-content">
		<p>As an early programmer, Headspring’s COO Jeffrey Palermo has recently revealed the challenges of beginning his software career and opened up on his experiences as a leader in a technical organization on the bi-weekly online audio show, Pluralcast.</p>
<p>“I started programming by creating a web page, and I was one of the early people who had an email address when if you ask someone ‘hey, what’s your email and they would ask, what’s that?!’”</p>
<p>As a six-time recipient of the Microsoft Most Valuable Professional (MVP), find out more about how Palermo found his passion for programming, his career advice, his methods of handling a leadership role and his approach to business and management.</p>
<p>Listen to the full podcast, by visiting the <a href="http://www.pluralsight-training.net/microsoft/pluralcast/default.aspx" target="_blank">Pluralcast website</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-10-13T00:00:00-05:00" pubdate data-updated="true">Oct 13<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/small-talk-and-big-news/'>Small Talk &amp; Big News</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/headsprings-first-intern/">
		
			Headspring’s First Intern</a>
	</h2>
	<div class="entry-content">
		<p>Logan Turner graduated in May 2011 from Grace Academy in Georgetown, Texas. Instead of taking the summer off to go on vacations, spend time with friends and sleep in like most teenagers, Logan decided to get an internship before going off to college. Currently a freshman at LeTourneau University, Logan interned with us at Headspring this summer to learn the ins and outs of being a business software consultant and to prepare for his future career as an engineer.</p>
<p>Logan is a bright and ambitious student who wanted a more technical and career-oriented summer experience before he went off to college in the fall. After acing a technical interviewing process filled with several interviews and tests, Logan began a beneficial summer of learning how to improve his programming skills. As a productive member of the team, Logan assisted on multiple projects and was able to put what he knew into practice and learn what this career path looks like from our employees.</p>
<p>We’re looking forward to seeing Logan develop his skills in the next few years and starting a successful career!</p>
<p>Logan’s school, Grace Academy, also wrote a great <a href="http://www.graceacademy-gt.org/index.php/ga-graduate-internship" target="_blank">article about his internship</a>.</p>
<p>If you or someone you know is interested in an internship position at Headspring, start the process <a href="http://www.headspring.com/careers/">here</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-10-13T00:00:00-05:00" pubdate data-updated="true">Oct 13<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/small-talk-and-big-news/'>Small Talk &amp; Big News</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/you-could-have-invented-lambda-expressions/">
		
			You Could Have Invented Lambda Expressions</a>
	</h2>
	<div class="entry-content">
		<p>Delegate types and lambda expressions have been a part of the .NET tool belt for a while now, so they show up everywhere. If you&#8217;ve ever used StructureMap, AutoMapper, ASP.NET MVC and the like, then you&#8217;ve surely run into them. Despite this, delegates and lambdas tend to confuse developers when first encountered. Even when you get comfortable with the syntax as it&#8217;s used in your favorite library, you might not really be familiar with what they <em>are</em> or how they allow for such seemingly magical statements.</p>
<p>Let&#8217;s pretend that delegate types and lambdas don&#8217;t exist yet, and then reinvent them in terms of other .NET concepts that are more widely understood.</p>
<p>Suppose we have been given an IEnumerable&lt;Customer&gt; and we want to filter that down to the list of those customers who live in Texas. Without delegates, we could write the obvious loop like so:</p>
<p><div><script src='https://gist.github.com/1253799.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Yeesh. I have written foreach-if-add loops a thousand times. Whenever we find ourselves writing virtually the same thing again and again, we should take a step back and think, &#8220;Is there a deeper concept here I could pull out into a library?&#8221; We have some subtle code duplication whenever we write foreach-if-add loops.</p>
<p>To remove duplication, we first identify what parts vary from one instance of the pattern to the next. For foreach-if-add loops, the things that vary are the type of the items being filtered, and the if-statement&#8217;s condition expression. To bottle up the foreach-if-add loop, we need a new method that takes in the condition as an <em>argument</em>. Without delegates, we could deal with this using an interface:</p>
<p><div><script src='https://gist.github.com/1253795.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Ok, so we&#8217;ve pulled out the foreach-if-add loop into a reusable <code>Where</code> extension method. Still, though, that&#8217;s a lot of boilerplate code: every time we want to call <code>Where</code> with a new filter, we have to bottle it up in a whole new class.</p>
<p>Let&#8217;s start removing boilerplate code until we&#8217;re left with delegates! With this example, we can <strong>imagine a whole family of interfaces that have one thing in common: interfaces with a single method named <code>RunMe</code>, whose implementing classes contain only that method.</strong> If we knew this family of interfaces only have one method, and its name was always <code>RunMe</code>, then we could avoid even writing its name: <code>condition.RunMe(item)</code> could be shortened to simply <code>condition(item)</code>. Since the relevant part of a single <code>IFilterCondition</code> implementation is the body of the now-nameless method, we should be able to simply provide the code for that method inline:</p>
<p><div><script src='https://gist.github.com/1253808.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p><strong>We can imagine that this use of the <code>delegate</code> keyword is just shorthand for an instance of a class implementing our single-method interface.</strong></p>
<p>Since most of these small unnamed classes exist just to evaluate and return a single expression, we might as well get rid of the <code>return</code> keyword and braces. Since we already know what the item type T is, we might as well leave out the type declaration of the <code>customer</code> parameter, allowing the compiler to fill in the blank. We&#8217;ll need <em>something</em> between the argument list and the return expression so the compiler knows which is which, so we introduce the =&gt; operator. This makes the <code>delegate</code> keyword redundant, leaving us with some valid (and clean!) C#:</p>
<p><div><script src='https://gist.github.com/1253881.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>There&#8217;s a lot more to delegates and lamda expressions, but in most cases I find it easiest to reason about them as shorthand for the interfaces and classes we would have otherwise used.</p>
<p>If you found this blog to be helpful <a href="http://www.headspring.com/feed" target="_blank">subscribe to our blog feed</a> for the freshest content.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-09-30T00:00:00-05:00" pubdate data-updated="true">Sep 30<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/crafting-an-extensible-reporting-schema/">
		
			Crafting an Extensible Reporting Schema</a>
	</h2>
	<div class="entry-content">
		<p>Traditional relational database schemas are designed to keep computers happy. Indexes, foreign keys, joins&#8230;all of these tools allow for the highest level of optimization so data can be recorded and read back in record time. However, humans are typically very <em>un</em>happy when it comes time to answer business questions from this data.</p>
<p>Imagine your boss approaches you and asks for a report of all orders placed by the Acme Corporation on Thursdays. You recall how many times you and your team optimized the database containing this information so data could be written at break-neck speeds and moan when you think of the complex script you&#8217;ll need to write to retrieve the report your boss requires. Wouldn&#8217;t it be nice if, instead of lines and lines of arcane SQL, we could ask a database something like the following and get back exactly what we expect?</p>
<pre>&lt;code&gt; select * from Orders where Customer = &#39;Acme&#39; and DayOfWeek = &#39;Thursday&#39;&lt;/code&gt;</pre>
<p>No joins, no convoluted date parsing&#8230;in fact, this SQL statement is almost identical to the sentence your boss used, isn&#8217;t it? How do we get to this level of utopian question-answering? The key is in the concept of &#8220;complex writes and simple reads&#8221;: instead of saving data to a database only in some crazy &#8220;normal form&#8221; fashion, flatten out your data so you can more easily query against it. Let&#8217;s take a look at a simple date&#8230;say, my birthday this year: 13 December 2011 2:18 PM.</p>
<p>Normally, we&#8217;d stick this value into a column designed for holding dates&#8230;and that&#8217;s fine, assuming the only question we&#8217;ll ever want to ask is &#8220;show me something that occurred on 13 December 2011 at 2:18 PM&#8221;. Unfortunately, that sort of question almost never gets asked. Instead, it&#8217;s queries like &#8220;on Tuesdays&#8221; or &#8220;in the afternoon&#8221;. To answer these questions, our schema needs to be modified a bit. The original &#8220;date-only&#8221; schema might look something like this:</p>
<pre>&lt;code&gt; OrderDate : datetime&lt;/code&gt;</pre>
<p>After we flatten out the date and time, our schema might look something like this:</p>
<pre>&lt;code&gt; Day : int Month : nvarchar Year : int DayOfWeek : nvarchar Hour : int Minute : int PM : bit&lt;/code&gt;</pre>
<p>Given this schema, we can now ask a multitude of questions about the single record represented, such as:</p>
<ul style="margin-bottom: 1.0em;">
<li>How many orders were placed in January?
<pre>&lt;code&gt; select count(1) from Orders where Month = &#39;January&#39;&lt;/code&gt;</pre>
</li>
<li>What orders did Acme place on Friday afternoons?
<pre>&lt;code&gt; select * from Orders where DayOfWeek = &#39;Friday&#39; and PM = &#39;1&#39;&lt;/code&gt;</pre>
</li>
</ul>
<p>Getting data into this type of schema is actually surprisingly easy; in fact, each of these values can be extracted from a single .NET DateTime object:</p>
<pre>&lt;code&gt; var timsBirthday = DateTime.Parse(&quot;13 December 2011 2:18 PM&quot;); var day = timsBirthday.Day; var month = timsBirthday.ToString(&quot;MMMM&quot;); var year = timsBirthday.Year; var dayOfWeek = timsBirthday.DayOfWeek; var hour = timsBirthday.Hour; var minute = timsBirthday.Minute; var pm = timsBirthday.Hour &amp;gt;= 12;&lt;/code&gt;</pre>
<p>It&#8217;s not just dates that can be flattened out in this manner! For a hypothetical generic Customer object, for example, you can extrapolate (and answer business questions on!) properties like these:</p>
<ul style="margin-bottom: 1.0em;">
<li>Name</li>
<li>Primary Contact</li>
<li>Phone</li>
<li>City</li>
<li>State</li>
<li>ZIP Code</li>
</ul>
<p>Happy reporting!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-09-28T00:00:00-05:00" pubdate data-updated="true">Sep 28<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>, <a class='category' href='/blog/categories/business-intelligence/'>business intelligence</a>, <a class='category' href='/blog/categories/reporting-schema/'>reporting schema</a>, <a class='category' href='/blog/categories/sql/'>sql</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/what-can-we-learn-from-calvin-hobbes/">
		
			What Can We Learn From Calvin & Hobbes?</a>
	</h2>
	<div class="entry-content">
		<p>A lot of people call me up when they need custom software to solve a problem. While each project is a little bit different, they typically fall within a few categories of maintainable software solutions. I’ve learned a valuable lesson about categories though: Sometimes you have to throw them out the window to clearly understand a problem…</p>
<p>Growing up I read a lot of Calvin and Hobbes. I’ve got every anthology including the leather-bound edition. As much as I love reading them, I find myself having to refocus halfway through a single strip. I tend to think that I know the ending to a given strip or series, and I skip ahead.</p>
<p>Oh, this is the one where he collects all the UPCs and gets a propeller beanie. I’m going to flip a few pages and see the look on his face when he doesn’t take off!</p>
<p>I always thought I had read every single Calvin and Hobbes. There was nothing about that kid and his tiger that I didn’t know.</p>
<p>A couple years ago, I was going back through my old collections and I found that I definitely hadn’t read every strip. In fact, I found that I had skipped most of the large Sunday illustrations because over the years I was skipping pages, thinking oh, I’ve read all of these storylines before.</p>
<p>It turns out those Sunday illustrations were the best. They were the ones that had cool stuff like T-Rex’s riding in fighter jets! (Spoiler alert for the shockingly Randy Quaid-less ending of Cowboys vs. Aliens).</p>
<p>I find that this same pattern shows up if I’m talking with a client who has a familiar problem. I have to focus myself on what they’re telling me so I don’t jump ahead in my mind to what I think the solution is. If I do that, I’ll miss out on all of the really important stuff they’re sharing- things that I wouldn’t have thought could be a part of the problem or answer. I want the Sunday edition of their story, I don’t want to hear the first panel and flip to my ending.</p>
<p>If a company is looking to become more agile, if they’re looking for an object-oriented development approach, or if they want us to modernize their legacy system, I have to put away my jump-to-conclusions mat- I might surprise myself and discover something I wouldn’t have found otherwise.</p>
<p>&nbsp;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-09-27T00:00:00-05:00" pubdate data-updated="true">Sep 27<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/small-talk-and-big-news/'>Small Talk &amp; Big News</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/headspring-sponsoring-open-source-hackathon/">
		
			Headspring Sponsoring Open Source Hackathon</a>
	</h2>
	<div class="entry-content">
		<p>In conjunction with <a href="http://lostechies.github.com/fiesta/">Pablo’s Fiesta</a>, an open-space development conference being held in Austin September 30-October 2, Headspring will be sponsoring an Open Source Hackathon at our offices on Sunday October 2nd from 1 PM to 6 PM. Over 150 developers from all over the United States and beyond are coming to Austin for 3 days of ‘sharpening the saw’, and the Los Techies Crew realized that with all that brainpower in one place, we ought to be able to do some concentrated work on the open source tools we all use so much.</p>
<p>If you’re attending the Fiesta, or even if you aren’t, feel free to come by the Headspring offices on Sunday to learn more about how open source software is written, ask questions about tools you’re using or would like to use, or even kick-start a new open-source project! Please bring a laptop if you can!</p>
<p>Get more details by going to the <a href="http://groups.google.com/group/pablos-fiesta-hackathon?hl=en_US">Google Group for Pablo’s Fiesta Hackathon</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-09-26T00:00:00-05:00" pubdate data-updated="true">Sep 26<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/small-talk-and-big-news/'>Small Talk &amp; Big News</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/using-jquery-in-asp-net-with-intellisense/">
		
			Using jQuery in ASP.NET With IntelliSense Correctly</a>
	</h2>
	<div class="entry-content">
		<p>When I&#8217;m teaching the MVC boot camp, I&#8217;m always amazed at how some of the smallest things are most impressive to students. One of the most common &#8220;wow&#8221; moments I see from students not familiar with jQuery is how you can trick Visual Studio to provide IntelliSense by including the vsdoc file, but make sure it still uses the min file for performance. That can be done by including the vsdoc file in an if(false) condition like below. This ensures it will never get included in the production code, which still tricking visual studio&#8217;s tooling to import the IntelliSense.</p>
<p style="text-align: center"><img class="aligncenter size-full wp-image-1871" src="http://www.headspring.com/wp-content/uploads/2011/09/jQuery-IntelliSense2.png" alt="" width="432" height="158" /></p>
<p>&nbsp;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-09-23T00:00:00-05:00" pubdate data-updated="true">Sep 23<span>rd</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>, <a class='category' href='/blog/categories/visual-studio/'>Visual Studio</a>, <a class='category' href='/blog/categories/jquery/'>jQuery</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/the-compilers-treatment-of-linq-syntax/">
		
			The Compiler&#8217;s Treatment of LINQ Syntax</a>
	</h2>
	<div class="entry-content">
		<p>When LINQ first became available, it was described as having a &#8220;lazy evaluation model&#8221;, meaning that a query would not actually be executed until you started to look at the result. Iterating through a result, for instance, would finally cause the query to actually run. This gives you the power to piece together a query over multiple statements before letting it execute.</p>
<p>Recently, I found that <em>this abstraction can leak</em>. I had a set of queries that were misbehaving, and it seemed that a bug would be reproducible in one set of queries but not in another, even though they were remarkably similar to each other in structure. The culprit was a big surprise: it turns out that <strong>the first &#8216;from&#8217; clause in a query is treated differently from subsequent &#8216;from&#8217; clauses</strong>. Although my project&#8217;s &#8216;from&#8217; clauses were not implemented with side effects, an example that does use side effects best illustrates what is going on. Consider the following:</p>
<p><div><script src='https://gist.github.com/1203504.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>If we trusted the explanations of LINQ queries as having a lazy evaluation model, we would expect the output to be:</p>
<pre>Before Loop
First Clause Side Effect
Second Clause Side Effect
Third Clause Side Effect
3</pre>
<p>We expect this because we&#8217;re told that the query doesn&#8217;t start doing any work until we start iterating throught the results. Surprisingly, the actual output is:</p>
<pre>First Clause Side Effect
Before Loop
Second Clause Side Effect
Third Clause Side Effect
3</pre>
<p>Yikes. <strong>The SQL-like query syntax is an abstraction over plain old method calls, and that abstraction is leaking.</strong> To make sense of what is going on, it is helpful to know what the compiler does every time it encounters query syntax. Before the compiler even bothers to determine whether your query is actually valid, it performs a plain text transformation to a series of specially-nested method calls. Only after that plain text transformation will it actually determine whether the methods being called exist, that the arguments passed to them are of the right type, etc. ReSharper can actually perform that transformation for you. When we do that to the query above, we get the following:</p>
<p><div><script src='https://gist.github.com/1203437.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>A query with multiple &#8216;from&#8217; clauses is transformed into a series of nested method calls. Lambda expressions are used to introduce a new local scope for the identifiers x, y, and z. SelectMany is an extension method, so the specific implementation is irrelevant during the plain text transformation. In other words, you can define the query syntax yourself, based on the type of the object you are selecting from (in this case, we&#8217;re using the default IEnumerable&lt;T&gt; implementation of SelectMany).</p>
<p><strong>The right hand side of the first from clause is evaluated immediately. Subsequent from clauses are evaluated lazily, because only they appear on the right hand side of a lambda operator =&gt;.</strong></p>
<p>By better-understanding what the compiler is actually doing with our LINQ queries, we can avoid frustrating surprises when the abstraction starts leaking.</p>
<p>If you found this blog to be helpful <a href="http://www.headspring.com/feed" target="_blank">subscribe to our blog feed</a> for the freshest content.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-09-08T00:00:00-05:00" pubdate data-updated="true">Sep 8<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/25/" class="prev">Prev</a>
    
    
        <a href="/blog/page/27/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Headspring Labs

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>