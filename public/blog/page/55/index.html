
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Headspring Labs</title>
	<meta name="author" content="Headspring Labs">

	
	<meta name="description" content="In Powershell and the Principle of Most Astonishment, I covered some of the surprises that new Powershell users encounter when trying to reliably &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Headspring Labs" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><a href="/"><h1>Headspring Labs</h1></a>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/team">The Team</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/open-source">Open Source</a></li>
	<li><a href="/about-us">About Us</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:headspringlabs.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/HeadspringLabs" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/HeadspringLabs" title="GitHub">GitHub</a>
		
	    
		
		<a class="coderwall" href="https://coderwall.com/team/headspring" title="Coderwall">Coderwall</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:headspringlabs.com">
	</form>
</nav>
<nav id="main-nav"><ul class="main">
	<li><a href="/team">The Team</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/open-source">Open Source</a></li>
	<li><a href="/about-us">About Us</a></li>
</ul>
</nav>

</header>
	
		
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/HeadspringLabs">HeadspringLabs</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('HeadspringLabs', 5, );
	})(jQuery);
</script>

	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/avoiding-on-error-resume-next-when-using-powershell/">
		
			Avoiding &#8220;on ERROR RESUME NEXT&#8221; When Using Powershell</a>
	</h2>
	<div class="entry-content">
		<p>In <a href="http://www.headspring.com/2011/07/powershell-and-the-principle-of-most-astonishment">Powershell and the Principle of Most Astonishment</a>, I covered some of the surprises that new Powershell users encounter when trying to reliably return results from functions. The next area where Powershell suprises new users is in its approach to error handling. Fortunately, there are some useful workarounds for making the surprising default behavior work more like you would expect.</p>
<p>While learning Powershell, I was trying to create a deployment script. The script needed to perform several tasks including, copying the deployment package to the target machine, setting up services, and the like. While testing it out locally, I would deliberately cause certain steps to fail in order to ensure that the user of the script would be clearly alerted to failures. To my surprise, when I caused exceptions to be thrown, the script would happily continue on to the next step, ultimately printing a success message to the user. Consider this example:</p>
<p><div><script src='https://gist.github.com/1149682.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>What the heck just happened? If you can&#8217;t rely on uncaught exceptions to stop execution, how can you reliably deal with failures? What if we throw an exception and then blindly move along to a subsequent step that <em>depends</em> on the success of previous steps?</p>
<p><strong>Powershell reintroduces VB&#8217;s &#8220;ON ERROR RESUME NEXT&#8221;, but goes one step further by making it the default!</strong> Abandon all hope, ye who etc, etc.</p>
<p>To make Powershell error handling work more like error handling in other .NET languages, we can set <strong>$global:ErrorActionPreference = &#8220;Stop&#8221;</strong> at the start of our script. With this variable set, uncaught exceptions thrown by Powershell code will cause the whole script to stop. Altering our example with this line, we get the output that we originally expected:</p>
<p><div><script src='https://gist.github.com/1149691.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>This solves most of our problem: the behavior of Powershell code that throws errors. Unfortunately, it doesn&#8217;t help us when we invoke an <em>external</em> executable that fails in the middle of our script. In my next post, I&#8217;ll show you how to address the failure of external executables.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-08-16T00:00:00-05:00" pubdate data-updated="true">Aug 16<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>, <a class='category' href='/blog/categories/powershell/'>Powershell</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/visual-studio-lightswitch-and-upgrade-path-for-microsoft-access-to-net/">
		
			Visual Studio Lightswitch, an Upgrade Path for Microsoft Access to .Net</a>
	</h2>
	<div class="entry-content">
		<p>There are lots of business systems written in Microsoft Access.  One of the most successful companies I know is <a href="http://www.fairsoftware.com/aboutgladstone.aspx">Gladstone, Inc</a>, makers of <a href="http://www.fairsoftware.com/">ShoWorks</a> software.  This software runs most of the county fairs in the U.S.  From entries, to checks, to vendors, this piece of software does it all to help manage and run a fair and keep track of all the data.  And it is written in Access.  Started on Access 97, I have watched this software grow through the various Access upgrades, and it tests the limits of the platform.  It’s author, <a href="http://www.hnatt.com/">Mike Hnatt</a>, is one of the premiere Access gurus, and Microsoft has previous invited him up to the Redmond campus to be a part of internal Software Design Reviews, or SDR’s.  Mike knows the limits of access, but even with the vast array of other development options out there, nothing comes close to parity with the capabilities he relies on – until today.</p>
<p><img style="border: 0pt none;" src="http://www.headspring.com/wp-content/uploads/2011/07/image_thumb9.png" alt="Application" width="524" height="333" border="0" /></p>
<p>This is my first <a href="http://www.microsoft.com/visualstudio/en-us/lightswitch">Lightswitch</a> application.  I just installed the software, ran it, defined a table structure and a few screens.  It’s really simple, and I see that i runs a desktop version of Silverlight.  It feels like Access (I have done some of that programming earlier in my career) because you just define the tables and queries, and then ask for screens that work off the data.  You can customize the screens to some degree, and you can write code behind the screens, just like you can write VBA behind Access screens.  This is my first time looking at Lightswitch in a serious way since it was just released.  I will be looking at it more because it belongs in our toolbelt at <a href="http://www.headspring.com">Headspring</a>.  There are plenty of clients who have Access and FoxPro systems.  These systems have tremendously useful built-in functionality that is prohibitively expensive to duplicate in a custom way with raw WPF and C#, but Lightswitch provides a possible upgrade path that won’t break the bank.</p>
<p>In case you are wondering what it looks like to develop this, here it is.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2011/07/image10.png"><img style="border: 0px;" src="http://www.headspring.com/wp-content/uploads/2011/07/image_thumb10.png" alt="image" width="510" height="304" border="0" /></a></p>
<p>Notice that there is a Solution Explorer, and you are in Visual Studio with a new project type.  I was really pleased that I could write code easily.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2011/07/image11.png"><img style="border: 0px;" src="http://www.headspring.com/wp-content/uploads/2011/07/image_thumb11.png" alt="image" width="513" height="315" border="0" /></a></p>
<p>I tried some <a href="http://www.jetbrains.com/resharper/">ReSharper</a> shortcuts, but they didn’t work.  I guess we’ll have to wait for ReSharper to enable this project type.  Here is my custom button that shows the message box.</p>
<p><a href="http://www.headspring.com/wp-content/uploads/2011/07/image12.png"><img style="border: 0px;" src="http://www.headspring.com/wp-content/uploads/2011/07/image_thumb12.png" alt="image" width="513" height="302" border="0" /></a></p>
<p>I think Lightswitch as a lot of promise for legacy system rewrites, upgrades, and conversions.  Because it’s 100% .Net, you can mix and match with web services, desktop, SQL Server, etc.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-07-30T00:00:00-05:00" pubdate data-updated="true">Jul 30<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/two-reasons-to-use-abstract-classes-in-c/">
		
			Two Reasons to Use Abstract Classes in C#</a>
	</h2>
	<div class="entry-content">
		<p>Do you find yourself writing the same methods over and over in different classes? Say your project needs both a &#8220;Dog&#8221; class and a &#8220;Cat&#8221; class &#8211; do you end up writing a &#8220;sleep&#8221; method for both? What if, in two months, the client needs you to add a &#8220;possum&#8221; to the system? Do you end up going in and retyping &#8220;sleep&#8221; instructions yet again? When you&#8217;re modeling a system with many similar parts, it takes way too much time and effort to keep duplicating code for each class. Imagine how hard it would be to maintain a large project with thousands of classes! Besides, it violates the DRY principle of good programming: Don&#8217;t Repeat Yourself! There must be a better way.</p>
<p>Thankfully, C# has built-in features for sharing code between classes. One of these is called an &#8220;abstract class&#8221;. Just create a new class with the keyword &#8220;abstract&#8221; (e.g. &#8220;public abstract class Mammal&#8221;) and write in its body all the methods you would like your other classes to share in common. Since an abstract class is still a class, your &#8220;Cat&#8221; and &#8220;Dog&#8221; classes can inherit from it using a colon (e.g. &#8220;public Cat : Mammal&#8221;). This means that instead of writing a &#8220;sleep&#8221; method for each animal, you only need to write it in the &#8220;Mammal&#8221; class, and the other animals will be able to use it too.<br />
But if any class can have inheritance, why not just use a regular class? The answer is that abstract classes have two special features:</p>
<p>1. They cannot be instantiated (made into objects),<br />
2. They can have special methods called &#8220;abstract methods&#8221;.</p>
<p>&#8220;Wait a minute,&#8221; you may be thinking, &#8220;Why would I want a class that can&#8217;t become an object?!&#8221; Sounds useless, right? However, consider the purpose of an abstract class: it contains common methods (and fields) that multiple child classes inherit from, but it does not attempt to follow these directions itself. In fact, a parent class is often missing vital information about the methods and fields it contains, because each child may use them a little bit differently. The &#8220;Mammal&#8221; abstract class only has what is common to all mammals &#8211; since some mammals can&#8217;t crawl and other mammals can&#8217;t gallop, the &#8220;Mammal&#8221; class can&#8217;t do either one. Imagine what would happen if you tried to instantiate a &#8220;generic&#8221; mammal: you&#8217;d get a featureless mass of hair, muscle and bone that probably wouldn&#8217;t survive on its own! In the same way, it is undesirable (sometimes dangerous!) to leave a class open to instantiation when it is simply a placeholder for common features. Guard against this possibility by using an abstract class.</p>
<p>What if two classes have methods so different that the only common factor is their name? This is where an abstract method comes in handy. An abstract method looks just like a normal method, except it has the word &#8220;abstract&#8221; (e.g. &#8220;abstract exampleMethod(args);&#8221; ) and a semicolon &#8220;;&#8221; instead of body brackets &#8220;{}&#8221;. What does it do? It basically tells each inheriting class to create its own method with that same name. For instance, since a dog and a bat both sleep, you could write a &#8220;sleep&#8221; method in the &#8220;Mammal&#8221; class. However, there are very few commonalities between a dog&#8217;s sleep and a bat&#8217;s sleep. So instead of trying to account for each individual animal&#8217;s sleeping habits, you would make the &#8220;sleep&#8221; method abstract. Now the code won&#8217;t even compile until each animal that inherits from &#8220;Mammal&#8221; has a method called &#8220;sleep&#8221;, using the &#8220;override&#8221; keyword to replace the abstract one (e.g. &#8220;public override sleep(args) {}&#8221; ). Now even though all mammals sleep, each individual mammal can sleep in its own way. After this, you may be wondering, &#8220;Why even bother putting that method in the parent class? Each inheritor is going to have its own version anyway.&#8221; You really do want to have that abstract class, not to prevent syntax errors, but to prevent human memory errors. You may know intellectually that all mammals sleep, but without a mechanism forcing you to write a &#8220;sleep&#8221; method for each mammal, it is all too easy to forget to do so. You may not even realize your mistake until you get a phone call from the client in the middle of the night. By refusing to compile until each abstract method is implemented in every inheriting class, the C# compiler is doing you a favor: it&#8217;s helping you remember the obvious.</p>
<p>Abstract classes help you improve your code not only through what they can do, but also through what they can&#8217;t. They can hold common features for many classes to inherit, without accidentally becoming objects themselves. They can also force you to write unique implementations of a common method, preventing human errors of forgetfulness. When you set up a class hierarchy, seriously consider whether you need a normal class to inherit from, or whether an abstract class will do. It may end up making the difference between a solid or buggy program.</p>
<p>Now, if only we had something to write the rest of our code for us&#8230;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-07-29T00:00:00-05:00" pubdate data-updated="true">Jul 29<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/dry/'>DRY</a>, <a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>, <a class='category' href='/blog/categories/best-practices/'>best practices</a>, <a class='category' href='/blog/categories/c-sharp/'>c sharp</a>, <a class='category' href='/blog/categories/class-inheritance/'>class inheritance</a>, <a class='category' href='/blog/categories/developing-with-c-number/'>developing with C#</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/true-confessions-public-shaming-and-test-driven-development/">
		
			True Confessions, Public Shaming, and Test-Driven Development</a>
	</h2>
	<div class="entry-content">
		<p>Okay, I admit it. Sometimes I write unit tests second instead of first. I also bite my nails and rest my elbows on the dinner table. But when I&#8217;ve got a bug to fix, and I&#8217;ve already found the offending line, I can hardly resist the urge to just&#8230; just&#8230; <em>change</em> it. I&#8217;ll follow up with unit tests afterwards, promise.</p>
<p>I admit this to you because admitting my wrongs is a step towards rehabilitation. I admit this to save you pain. Learn from my example. Test-second is so much less efficient than test-first. Consider the following workflow:</p>
<ol>
<li>Reproduce, identify, debug the issue.</li>
<li>Fix the code.</li>
<li>Compile and try it out.</li>
<li>Write a test that proves I fixed it.</li>
<li>Compile and run the test.</li>
<li>Change the code back to make sure my test really proves what it is trying to prove.</li>
<li>Compile and see the test fail.</li>
<li>Re-fix the code.</li>
<li>Compile and see the test pass.</li>
</ol>
<p>&nbsp;</p>
<p>I humble myself before you. How much time am I wasting there? It&#8217;s embarrassing.</p>
<p>There&#8217;s also a subtle point in step 1. What if I could use unit tests instead of the debugger to find the issue? That will be faster, too.</p>
<p>We can do better:</p>
<ol>
<li>Reproduce the issue and formulate a theory.</li>
<li>Write a test that exercises the theory.</li>
<li>Compile and see the test fail, corroborating the theory.</li>
<li>Fix the code.</li>
<li>Compile and see the test pass, validating the theory.</li>
</ol>
<p>&nbsp;</p>
<p>Perhaps you can relate. Perhaps you even bite your nails, too. I won&#8217;t judge. Flog me or join me, the comments are open: Confess your bad habits (um, your <em>unit-testing</em> bad habits, please), and commit yourself to improvement. I challenge you to improve your efficiency and write your unit tests first, even—especially—for the little bug fixes.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-07-29T00:00:00-05:00" pubdate data-updated="true">Jul 29<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/bonus/'>Bonus!</a>, <a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>, <a class='category' href='/blog/categories/continuous-improvement/'>continuous improvement</a>, <a class='category' href='/blog/categories/developer-productivity/'>developer productivity</a>, <a class='category' href='/blog/categories/test-driven-development/'>test-driven development</a>, <a class='category' href='/blog/categories/unit-testing/'>unit testing</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/the-secret-sauce-of-business-intelligence-olap-vs-relational-schemas/">
		
			The Secret Sauce of Business Intelligence: OLAP vs Relational Schemas</a>
	</h2>
	<div class="entry-content">
		<p>Ever heard the terms <em>star schema, OLAP, fact table, dimension, </em>or<em> business intelligence</em> and wondered what they meant and/or why you should care?  I learned what these terms meant five years ago, and I have found powerful usages for these concepts ever since.</p>
<p>Imagine your business owner is a restaurant manager.  You&#8217;ve built a point of sale system that records what customers have ordered.  Begrudgingly, you have also built some canned reports to list out sales transactions within a user-entered date range.  The restaurant manager could browse the transaction history for a particular month to learn which menu items customers seem to like and at what times they tend to eat.  However, it will be difficult to really quantify those trends.  Are sales for the Caesar Salad going up or down?  How many more Caesar Salads were ordered than House Salads?  What was the most popular hour of the day to dine during weekdays?  On the weekends?  Inevitably, your business owner will get tired of trekking down to your desk to ask you those questions, and you will get tired of creating a seemingly endless set of &#8220;canned&#8221; reports.</p>
<p>Wouldn&#8217;t it be great if your client could answer those questions herself?  She can - she just needs a business intelligence solution!</p>
<p>First, design a star schema.  A star schema is a special type of relational database schema that has at least one <em>fact table</em> and zero to many <em>dimension tables</em>.  The dimension tables are optional, so let&#8217;s focus on the fact table.  A fact table has two types of columns, dimensions and facts.  <em>Dimension columns</em> for our sales fact table would include Hour of Day, Date, Month, Quarter, Year, Day Type (Weekday, Weekend), Product Category (Salad, Appetizer, Main Course, etc.), and Product.  Notice, although all of the date-related fields could be inferred from a transaction time-stamp, all of the columns are broken out individually.  This is an example of the secret sauce of business intelligence - <em>denormalization</em>. Also, the Hour of Day column should have user-readable values such as &#8220;3:00 PM - 4:00 PM&#8221;, not 15 or 15:00.  Our fact table could only have a single <em>fact column, </em>amount.</p>
<p>Second, build an ETL (Extract, Transform, Load) process.  This process should run every night and import new records from the transactional point of sales system (OLTP) database into your star schema.  In some cases, it might just be easier to replace all of the data in your star schema on a nightly basis - it just depends on how much data you have.</p>
<p>Third, use Excel&#8217;s ability to connect to a database server and add PivotTable functionality on top of your sales fact table.  Before you know it, your business user will be answering all of the questions I raised before, and a thousand others - without having to hound you for new canned reports!</p>
<p>p.s.  OLAP is a different kind of data structure that can be built directly from your star schema.  It&#8217;s important when you have an enormous amount of data that must be sliced and diced quickly.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-07-29T00:00:00-05:00" pubdate data-updated="true">Jul 29<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/bonus/'>Bonus!</a>, <a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/54/" class="prev">Prev</a>
    
    
        <a href="/blog/page/56/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Headspring Labs

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>