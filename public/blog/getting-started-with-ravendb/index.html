
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Getting Started with RavenDB - Headspring Labs</title>
  <meta name="author" content="Headspring Labs">

  
  <meta name="description" content="I have been following the NoSQL movement for a while now. I have blogged about the movement and even written a how to post on setting up a popular &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://headspringlabs.com/blog/getting-started-with-ravendb">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Headspring Labs" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Headspring Labs</a></h1>
  
    <h2>Experiments by Headspringers!</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:headspringlabs.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Getting Started With RavenDB</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-19T00:00:00-05:00" pubdate data-updated="true">Mar 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I have been following the NoSQL movement for a while now. I have <a href="http://alonsorobles.com/2012/01/10/nosql-big-data-polyglot-persistence-a-new-era/">blogged about the movement</a> and even written a how to post on <a href="http://alonsorobles.com/2011/08/08/running-apache-cassandra-0-8-2-on-windows-7/">setting up a popular column oriented data store</a>. It’s exciting to see the development of so many persistence alternatives. Don’t get me wrong either. The RDBMS is not dead. It just no longer the only kid on the block.</p>
<p>Document databases are another persistence alternative to the traditional RDBMS and there are plenty to chose from (like <a href="http://couchdb.apache.org/">CouchDB</a>, <a href="http://aws.amazon.com/simpledb/">SimpleDB</a>, <a href="http://ravendb.net/">RavenDB</a>,  and <a href="http://wiki.basho.com/Riak.html">Riak</a> to name a few). This post is intended to help get you started using RavenDB.</p>
<p>Let’s get started!<!--more--></p>
<h3><span style="font-weight: bold;">Installing RavenDB</span></h3>
<p>There are <a href="http://ravendb.net/download">a few different options for obtaining RavenDB</a>. When it’s available, I prefer using <a href="http://nuget.org/">Nuget</a> via the package manager console. So that’s how we are going to do it… Here we go.</p>
<p>I am assuming you already have a Visual Studio solution with some projects in it. I have a class library project targeting the .NET 4.0 framework called Persistence where all of my persistence logic goes. Using the package manager console, I install the RavenDB package.</p>
<p><div><script src='https://gist.github.com/1987578.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>From the output you can see a number of dependencies were installed. Feel free to hit your easy button now.</p>
<h3><span style="font-weight: bold;">Starting the Server</span></h3>
<p>The next thing we need to do is to start up the server. Please note that these steps are here to get you started, not the steps you should follow for production use. I’ll throw in some other pointers along the way.</p>
<p>To start the server, open up windows explorer and navigate to your solution directory. You should find a packages directory there which was created by Nuget.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-32" rel="attachment wp-att-3954"><img class="alignnone size-medium wp-image-3954" src="http://www.headspring.com/wp-content/uploads/2012/03/image.png" alt="" width="440" height="232" /></a></p>
<p>Navigate into the packages directory, then into the RavenDB directory, then into the server directory and locate the Raven.Server.exe file.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-33" rel="attachment wp-att-3956"><img class="alignnone size-medium wp-image-3956" src="http://www.headspring.com/wp-content/uploads/2012/03/image1.png" alt="" width="440" height="232" /></a></p>
<p>Double click the Raven.Server.exe file to start the server. This will start a console window that looks like this:</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-34" rel="attachment wp-att-3958"><img class="alignnone size-medium wp-image-3958" src="http://www.headspring.com/wp-content/uploads/2012/03/image2.png" alt="" width="440" height="232" /></a></p>
<p>Feel free to hit that easy button again!</p>
<p>The server has automatically created a data directory and started an HTTP server on port 8080. These settings can be changed in the Raven.Server.exe.config file as needed. Let’s move on.</p>
<h3><span style="font-weight: bold;">The Basics</span></h3>
<p>Before we start fiddling with data, we need to understand the basic mechanics of a document database. The concepts are pretty easy, but can be a mental leap if you spent years working with traditional relational databases. Here are the basic concepts from the top down.</p>
<p><strong>Database </strong>– The server is made up of database instances. Each database is made up of document collections. I like to think of a database like a filing cabinet.</p>
<p><strong>Collection</strong> – The instance is made up of collections which are nothing more than logical grouping of documents. I like to think of them as a folder or a bin that contain related documents.</p>
<p><strong>Document</strong> – A document is a single unit of data. It is made up of fields. Think about an email. It is a document which contains a single sender, one or more recipients, a subject, a timestamp, and a body. It is important to note that every document does not necessarily contain all the fields. That means there is no enforced schema for the documents. It may be helpful to think about a handwritten letter. A letter will most likely contain a recipient, a body, and a sender. But you could optionally add a return address, a subject line, a post script message, and/or a date.</p>
<p><strong>Field</strong> – A field is a key value pair. The key describes the contents of the field. The value maybe an array or a scalar value. It could also be a document or an array of documents. They are pretty flexible.</p>
<p>If you are still having a hard time wrapping your mind around these concepts, then you may find it useful to conceptually map these terms to relational data terms. Just remember that these mappings are not literally identical, they are somewhat similar concepts. I have also added a real world equivalent for comparison.</p>
<table width="374" border="1" cellspacing="0" cellpadding="2">
<tbody>
<tr>
<td valign="top" width="195"><strong>Document DB Concept/Term</strong></td>
<td valign="top" width="177"><strong>Similar SQL Concept/Term</strong></td>
</tr>
<tr>
<td valign="top" width="208">Database</td>
<td valign="top" width="183">Database</td>
</tr>
<tr>
<td valign="top" width="211">Collection</td>
<td valign="top" width="186">Table</td>
</tr>
<tr>
<td valign="top" width="211">Document</td>
<td valign="top" width="187">Row</td>
</tr>
<tr>
<td valign="top" width="210">Field</td>
<td valign="top" width="188">Column</td>
</tr>
</tbody>
</table>
<p>You may still not fully understand the difference and that’s okay. The differences will become more apparent as you play with document databases.</p>
<p>Let’s get some hands on experience now.</p>
<p>Fire up the management studio by using your favorite browser and navigating to http://localhost:8080 while the server is still running.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-35" rel="attachment wp-att-3960"><img class="alignnone size-medium wp-image-3960" src="http://www.headspring.com/wp-content/uploads/2012/03/image3.png" alt="" width="440" height="286" /></a></p>
<p>By default, the RavenDB server has created a “Default” database instance and that is the instance the management studio has connected to. The first thing we are going to do is create a database instance that we will use for the remainder of this discussion.</p>
<p>Click on the “Database” link towards the top right of the studio.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-36" rel="attachment wp-att-3962"><img class="alignnone size-medium wp-image-3962" src="http://www.headspring.com/wp-content/uploads/2012/03/image4.png" alt="" width="440" height="286" /></a></p>
<p>Next click on the “New Database” button.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-37" rel="attachment wp-att-3964"><img class="alignnone size-medium wp-image-3964" src="http://www.headspring.com/wp-content/uploads/2012/03/image5.png" alt="" width="300" height="96" /></a></p>
<p>Enter “ShoppingCartDemo” for the database name and click the “OK” button. You may be prompted for credentials. Go ahead and enter them.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-38" rel="attachment wp-att-3966"><img class="alignnone size-medium wp-image-3966" src="http://www.headspring.com/wp-content/uploads/2012/03/image6.png" alt="" width="440" height="286" /></a></p>
<p>Click on the “ShoppingCartDemo” database. Notice the navigation bar changed from “Databases &gt; Default” to “Databases &gt; ShoppingCartDemo”.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-39" rel="attachment wp-att-3968"><img class="alignnone size-medium wp-image-3968" src="http://www.headspring.com/wp-content/uploads/2012/03/image7.png" alt="" width="440" height="286" /></a></p>
<p>Congrats! You now have a new database instance and the management studio is now working in its context.</p>
<p>We could have done the same thing with some code. It looks like this.</p>
<p><div><script src='https://gist.github.com/2176197.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Now we are ready to add some data.</p>
<h3><span style="font-weight: bold;">Creating Documents</span></h3>
<p>First we need to define our classes. We can do that with some simple C# like this:</p>
<p><div><script src='https://gist.github.com/1988820.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Then the application can do something like this:</p>
<p><div><script src='https://gist.github.com/2176205.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>After that code is executed by the application you can see a few things in the RavenDB management studio.</p>
<p>Let’s take a look at the collections page which can be accessed by clicking the “Collections” tab at the top of the studio.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-33" rel="attachment wp-att-3956"><img class="alignnone size-medium wp-image-3956" src="http://www.headspring.com/wp-content/uploads/2012/03/image8.png" alt="" width="440" height="286" /></a></p>
<p>Notice that RavenDB has created a “ShoppingCarts” collection for us. This collection is a logical grouping of the ShoppingCart documents. Now click on the pencil icon on the document.</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-33" rel="attachment wp-att-3956"><img class="alignnone size-medium wp-image-3956" src="http://www.headspring.com/wp-content/uploads/2012/03/image9.png" alt="" width="440" height="286" /></a></p>
<p>Notice that the document is just a JSON serialized representation of the created cart. There is some metadata that RavenDB keeps to help it serialize and deserialize the JSON documents to plain old CLR objects.</p>
<p>Now we can retrieve documents.</p>
<h3><span style="font-weight: bold;">Retrieving Documents</span></h3>
<p>We can now retrieve the shopping cart.</p>
<p><div><script src='https://gist.github.com/2176209.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<h3></h3>
<h3><span style="font-weight: bold;">Updating Documents</span></h3>
<p>After retrieving a document, you will probably want to persist changes to it. This easy pretty easy to do.</p>
<p>We can refactor the shopping cart class a little here. By changing the array of line items to a list of line items, we can now easily add items to the cart.</p>
<p><div><script src='https://gist.github.com/1989715.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Now our application can make changes like this:</p>
<p><div><script src='https://gist.github.com/2176221.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Take a look at the document data in the management studio</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-33" rel="attachment wp-att-3956"><img class="alignnone size-medium wp-image-3956" src="http://www.headspring.com/wp-content/uploads/2012/03/image10.png" alt="" width="440" height="286" /></a></p>
<p>Notice that the change in the shopping cart class had no impact in this operation. This is one of the neat features of a document DB. Adding and changing fields is pretty easy without having to worry about migrating data most of the time. There are some caveats with this. But that is a topic for another discussion.</p>
<h3></h3>
<h3><span style="font-weight: bold;">Deleting Documents</span></h3>
<p>We can now add a delete a cart easily like this:</p>
<p><div><script src='https://gist.github.com/2176223.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>Take another look at collections tab in the management studio:</p>
<p><a href="http://www.headspring.com/2012/03/getting-started-with-ravendb/image-png-33" rel="attachment wp-att-3956"><img class="alignnone size-medium wp-image-3956" src="http://www.headspring.com/wp-content/uploads/2012/03/image11.png" alt="" width="440" height="286" /></a></p>
<p>Notice the document is gone, but RavenDB remembers the ShoppingCarts collection.</p>
<p>We have looked at:</p>
<ol>
<li>How to install RavenDB using Nuget for development</li>
<li>How to start up the RavenDB server (again for development and tinkering)</li>
<li>How to access the management studio</li>
<li>How to create a database using code and the studio</li>
<li>How to perform simplistic CRUD operations (create, retrieve, update, and delete) using the RavenDB client.</li>
</ol>
<p>There is much more to discuss about Raven. Make sure you look at the <a href="http://ravendb.net/">official RavenDB site for more information</a>.</p>
<p><strong>Update:</strong> Thanks for the feedback. I removed the repository pattern from the examples as the implementation example was taking away from the intent of the post.</p>
</div>


  <footer>
    <p class="meta">
      
  



      








  


<time datetime="2012-03-19T00:00:00-05:00" pubdate data-updated="true">Mar 19<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>, <a class='category' href='/blog/categories/nosql/'>nosql</a>, <a class='category' href='/blog/categories/ravendb/'>ravendb</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://headspringlabs.com/blog/getting-started-with-ravendb/" data-via="HeadspringLabs" data-counturl="http://headspringlabs.com/blog/getting-started-with-ravendb/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/get-to-know-a-developer-alonso-robles/" title="Previous Post: Get to Know a Developer: Alonso Robles">&laquo; Get to Know a Developer: Alonso Robles</a>
      
      
        <a class="basic-alignment right" href="/blog/how-not-to-say-um-when-presenting/" title="Next Post: How Not to Say "Um" When Presenting">How Not to Say "Um" When Presenting &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/dry-test-inheritance/">DRY Test Inheritance</a>
      </li>
    
      <li class="post">
        <a href="/blog/the-sincerest-form-of-flattery/">The Sincerest Form of Flattery</a>
      </li>
    
      <li class="post">
        <a href="/blog/fixies-life-bicycle/">Fixie's Life Bicycle</a>
      </li>
    
      <li class="post">
        <a href="/blog/test-discovery/">Test Discovery</a>
      </li>
    
      <li class="post">
        <a href="/blog/enabling-change/">Enabling Change</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/HeadspringLabs">@HeadspringLabs</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'HeadspringLabs',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Headspring Labs -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
