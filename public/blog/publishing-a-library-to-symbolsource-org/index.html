
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Publishing a Library to SymbolSource.org - Headspring Labs</title>
	<meta name="author" content="Headspring Labs">

	
	<meta name="description" content="Last week, we saw how to publish a library with NuGet. By including DLL files in our NuGet package under the special &#8220;lib&#8221; folder, NuGet &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Headspring Labs" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><a href="/"><h1>Headspring Labs</h1></a>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/team">The Team</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/open-source">Open Source</a></li>
	<li><a href="/about-us">About Us</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:headspringlabs.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/HeadspringLabs" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/HeadspringLabs" title="GitHub">GitHub</a>
		
	    
		
		<a class="coderwall" href="https://coderwall.com/team/headspring" title="Coderwall">Coderwall</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:headspringlabs.com">
	</form>
</nav>
<nav id="main-nav"><ul class="main">
	<li><a href="/team">The Team</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/open-source">Open Source</a></li>
	<li><a href="/about-us">About Us</a></li>
</ul>
</nav>

</header>
	
		
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/HeadspringLabs">HeadspringLabs</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('HeadspringLabs', 5, );
	})(jQuery);
</script>

	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Publishing a Library to SymbolSource.org</h2>
	<div class="entry-content"><p>Last week, we saw how to <a href="http://www.headspring.com/2012/03/publishing-a-library-with-nuget">publish a library with NuGet</a>.  By including DLL files in our NuGet package under the special &#8220;lib&#8221; folder, NuGet knows to install them as assembly references in the target project.  This is a great way to get your open-source library into the hands of your audience, but it also provides them with a pretty lame debugging scenario.</p>
<h2>Black Box Debugging</h2>
<p>Using that NuGet package from last week, I installed <a href="https://github.com/plioi/parsley">Parsley</a> into another project that consumes it.  While trying to debug <em>that</em> project, I got to a point where I wanted to just step the debugger into one of Parsley&#8217;s methods.  Even with the PDB file included in the NuGet package, Visual Studio just plain didn&#8217;t have enough information to let me step through Parsley&#8217;s code.</p>
<p>Too much information about the original source gets lost when a PDB is produced.  We need to make the source code available to the consumer when they install our packages, and we need to so in a way that Visual Studio can take advantage of at debugging time.</p>
<h2>Publishing a Symbol Package</h2>
<p>Fortunately there is a free service, <a href="http://SymbolSource.org">SymbolSource.org</a>, which is easy to integrate with both NuGet (for the publisher) and Visual Studio (for the consumer).  Although getting a SymbolSource account is an option, you won&#8217;t actually need one.  You&#8217;ll be able to publish a special variant of your NuGet package to NuGet.org, and then NuGet.org shakes hands with SymbolSource.org on your behalf.  All it takes is a slight tweak to your <code>.nuspec</code> file, and an extra command-line argument when converting that <code>.nuspec</code> into a <code>.nupkg</code>!</p>
<p>The previous version of my <code>.nuspec</code>&#8217;s <code>files</code> tag just copied DLLs and PDBs into the package&#8217;s special &#8220;lib&#8221; folder:</p>
<p><div><script src='https://gist.github.com/2231973.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>The new version also copies all of the source code to the package&#8217;s special &#8220;src&#8221; folder.  We don&#8217;t need to copy auxiliary files like <code>.csproj</code> or <code>.sln</code>.  We just need to copy the code files that the debugger will need to display, namely all the *.cs files:</p>
<p><div><script src='https://gist.github.com/2288725.js'></script>
<noscript><pre><code></code></pre></noscript></div>
</p>
<p>I used this single <code>.nuspec</code> to produce <em>two</em> <code>.nupkg</code> files, by including the <code>-Symbols</code> command line argument:</p>
<blockquote><p>
  $ nuget pack Parsley.nuspec -Symbols
</p></blockquote>
<p>This produced Parsley.0.0.2.nupkg like normal, but it also produced Parsley.0.0.2.symbols.nupkg.  NuGet.exe is smart enough to know that the first package only needed the DLLs (used at installation time), and that the symbol package needs to contain the PDBs and C# files (used at debugging time).  When I pushed the main package to NuGet.org, NuGet.exe noticed the symbol package was also present, and submitted that one too:</p>
<blockquote>
<p>$ nuget push Parsley.0.0.2.nupkg<br />
    Pushing Parsley 0.0.2 to the NuGet gallery (https://www.nuget.org)&#8230;<br />
    Your package was pushed.<br />
    Pushing Parsley 0.0.2 to the symbol server (http://nuget.gw.symbolsource/Public/NuGet)&#8230;<br />
    Your package was pushed.</p>
</blockquote>
<p>I then followed the instructions for <a href="http://www.symbolsource.org/Public/Home/VisualStudio">configuring Visual Studio to work with SymbolSource.org</a>.  Remember, you don&#8217;t have to follow the suggestion to create a SymbolSource account.</p>
<p>I updated the package in the consumer project, which installed the DLLs.  The next time I tried to step into a Parsley method, I got a quick dialog that said it was downloading the relevant files from SymbolSource, and then I was able to step through the read-only C# files found within the symbol package!</p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-04-06T00:00:00-05:00" pubdate data-updated="true">Apr 6<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/developer-deep-dive/'>Developer Deep Dive</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Headspring Labs

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>