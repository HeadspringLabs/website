
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Crafting an Extensible Reporting Schema - Headspring Labs</title>
  <meta name="author" content="Headspring Labs">

  
  <meta name="description" content="Traditional relational database schemas are designed to keep computers happy. Indexes, foreign keys, joins&#8230;all of these tools allow for the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://headspringlabs.com/blog/crafting-an-extensible-reporting-schema">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Headspring Labs" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Headspring Labs</a></h1>
  
    <h2>Experiments by Headspringers!</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:headspringlabs.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Crafting an Extensible Reporting Schema</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-28T00:00:00-05:00" pubdate data-updated="true">Sep 28<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Traditional relational database schemas are designed to keep computers happy. Indexes, foreign keys, joins&#8230;all of these tools allow for the highest level of optimization so data can be recorded and read back in record time. However, humans are typically very <em>un</em>happy when it comes time to answer business questions from this data.</p>
<p>Imagine your boss approaches you and asks for a report of all orders placed by the Acme Corporation on Thursdays. You recall how many times you and your team optimized the database containing this information so data could be written at break-neck speeds and moan when you think of the complex script you&#8217;ll need to write to retrieve the report your boss requires. Wouldn&#8217;t it be nice if, instead of lines and lines of arcane SQL, we could ask a database something like the following and get back exactly what we expect?<!--more--></p>
<pre>&lt;code&gt; select * from Orders where Customer = &#39;Acme&#39; and DayOfWeek = &#39;Thursday&#39;&lt;/code&gt;</pre>
<p>No joins, no convoluted date parsing&#8230;in fact, this SQL statement is almost identical to the sentence your boss used, isn&#8217;t it? How do we get to this level of utopian question-answering? The key is in the concept of &#8220;complex writes and simple reads&#8221;: instead of saving data to a database only in some crazy &#8220;normal form&#8221; fashion, flatten out your data so you can more easily query against it. Let&#8217;s take a look at a simple date&#8230;say, my birthday this year: 13 December 2011 2:18 PM.</p>
<p>Normally, we&#8217;d stick this value into a column designed for holding dates&#8230;and that&#8217;s fine, assuming the only question we&#8217;ll ever want to ask is &#8220;show me something that occurred on 13 December 2011 at 2:18 PM&#8221;. Unfortunately, that sort of question almost never gets asked. Instead, it&#8217;s queries like &#8220;on Tuesdays&#8221; or &#8220;in the afternoon&#8221;. To answer these questions, our schema needs to be modified a bit. The original &#8220;date-only&#8221; schema might look something like this:</p>
<pre>&lt;code&gt; OrderDate : datetime&lt;/code&gt;</pre>
<p>After we flatten out the date and time, our schema might look something like this:</p>
<pre>&lt;code&gt; Day : int Month : nvarchar Year : int DayOfWeek : nvarchar Hour : int Minute : int PM : bit&lt;/code&gt;</pre>
<p>Given this schema, we can now ask a multitude of questions about the single record represented, such as:</p>
<ul style="margin-bottom: 1.0em;">
<li>How many orders were placed in January?
<pre>&lt;code&gt; select count(1) from Orders where Month = &#39;January&#39;&lt;/code&gt;</pre>
</li>
<li>What orders did Acme place on Friday afternoons?
<pre>&lt;code&gt; select * from Orders where DayOfWeek = &#39;Friday&#39; and PM = &#39;1&#39;&lt;/code&gt;</pre>
</li>
</ul>
<p>Getting data into this type of schema is actually surprisingly easy; in fact, each of these values can be extracted from a single .NET DateTime object:</p>
<pre>&lt;code&gt; var timsBirthday = DateTime.Parse(&quot;13 December 2011 2:18 PM&quot;); var day = timsBirthday.Day; var month = timsBirthday.ToString(&quot;MMMM&quot;); var year = timsBirthday.Year; var dayOfWeek = timsBirthday.DayOfWeek; var hour = timsBirthday.Hour; var minute = timsBirthday.Minute; var pm = timsBirthday.Hour &amp;gt;= 12;&lt;/code&gt;</pre>
<p>It&#8217;s not just dates that can be flattened out in this manner! For a hypothetical generic Customer object, for example, you can extrapolate (and answer business questions on!) properties like these:</p>
<ul style="margin-bottom: 1.0em;">
<li>Name</li>
<li>Primary Contact</li>
<li>Phone</li>
<li>City</li>
<li>State</li>
<li>ZIP Code</li>
</ul>
<p>Happy reporting!</p>
</div>


  <footer>
    <p class="meta">
      
  



      








  


<time datetime="2011-09-28T00:00:00-05:00" pubdate data-updated="true">Sep 28<span>th</span>, 2011</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://headspringlabs.com/blog/crafting-an-extensible-reporting-schema/" data-via="HeadspringLabs" data-counturl="http://headspringlabs.com/blog/crafting-an-extensible-reporting-schema/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/what-can-we-learn-from-calvin-hobbes/" title="Previous Post: What can we learn from Calvin & Hobbes?">&laquo; What can we learn from Calvin & Hobbes?</a>
      
      
        <a class="basic-alignment right" href="/blog/you-could-have-invented-lambda-expressions/" title="Next Post: You could have invented lambda expressions">You could have invented lambda expressions &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/dry-test-inheritance/">DRY Test Inheritance</a>
      </li>
    
      <li class="post">
        <a href="/blog/the-sincerest-form-of-flattery/">The Sincerest Form of Flattery</a>
      </li>
    
      <li class="post">
        <a href="/blog/fixies-life-bicycle/">Fixie's Life Bicycle</a>
      </li>
    
      <li class="post">
        <a href="/blog/test-discovery/">Test Discovery</a>
      </li>
    
      <li class="post">
        <a href="/blog/enabling-change/">Enabling Change</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/HeadspringLabs">@HeadspringLabs</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'HeadspringLabs',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Headspring Labs -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
